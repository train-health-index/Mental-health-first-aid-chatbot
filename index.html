<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MindAid Pro - A mental health first aid assistant">
    <meta name="author" content="MindAid Team">
    <title>MindAid Pro - Mental Health First Aid Assistant</title>
    <!-- Boxicons CDN -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <!-- Poppins Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Confetti.js -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #ff6f91;
            --primary-dark: #e05577;
            --secondary: #a29bfe;
            --secondary-dark: #7f7bff;
            --accent: #feca57;
            --background: #f4e7ff;
            --card-bg: rgba(255, 255, 255, 0.2);
            --text: #2d3436;
            --success: #55efc4;
            --info: #74c0fc;
            --container-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--background) 0%, #ffdeeb 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container, .auth-container {
            width: 100%;
            max-width: 1200px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--container-shadow);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .auth-container {
            max-width: 400px;
            padding: 40px;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auth-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .auth-form input {
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            transition: var(--transition);
        }

        .auth-form input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .auth-form button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .auth-form button:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .auth-toggle {
            color: var(--secondary);
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .auth-toggle:hover {
            color: var(--secondary-dark);
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 95vh;
        }

        header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-icon i {
            font-size: 20px;
        }

        .logo-text h1 {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .logo-text .subtitle {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .user-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .user-btn, .chat-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chat-btn {
            background: var(--primary);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .user-btn:hover, .chat-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .chat-btn:hover {
            background: var(--primary-dark);
        }

        .language-selector {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .language-selector:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
        }

        .app-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 240px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            border-left: 4px solid transparent;
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            font-size: 20px;
            color: var(--secondary);
        }

        .nav-item.active, .nav-item:hover {
            background: rgba(162, 155, 254, 0.2);
            color: var(--secondary-dark);
            border-left: 4px solid var(--secondary-dark);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .motivational {
            background: linear-gradient(45deg, var(--success) 0%, #00b894 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            font-style: italic;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(85, 239, 196, 0.3);
        }

        .chat-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 75%;
            padding: 12px 18px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bot-message {
            background: rgba(162, 155, 254, 0.2);
            border: 1px solid rgba(162, 155, 254, 0.3);
            border-bottom-left-radius: 4px;
            align-self: flex-start;
        }

        .user-message {
            background: rgba(255, 111, 145, 0.2);
            border-bottom-right-radius: 4px;
            align-self: flex-end;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 6px;
            display: block;
        }

        .typing-indicator {
            display: inline-flex;
            padding: 12px 18px;
            background: rgba(162, 155, 254, 0.2);
            border-radius: 15px;
            border-bottom-left-radius: 4px;
            align-self: flex-start;
            border: 1px solid rgba(162, 155, 254, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            margin: 0 3px;
            animation: typing 1.2s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }

        .crisis-alert {
            background: linear-gradient(90deg, #ff7675 0%, #d63031 100%);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(255, 118, 117, 0.3);
        }

        .resources-card {
            background: var(--info);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(116, 192, 252, 0.3);
        }

        .input-container {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            gap: 10px;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
        }

        #user-input {
            flex: 1;
            padding: 12px 18px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            outline: none;
            font-size: 0.9rem;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
        }

        #user-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .quick-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .quick-reply {
            background: rgba(255, 111, 145, 0.1);
            color: var(--primary);
            border: 1px solid rgba(255, 111, 145, 0.3);
            border-radius: 12px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .quick-reply:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .tab-title {
            font-size: 1.6rem;
            color: var(--text);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-title i {
            background: var(--secondary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--container-shadow);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-header i {
            color: var(--primary);
            font-size: 18px;
        }

        .card-body {
            padding: 15px;
        }

        .resource-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .resource-item:last-child {
            border-bottom: none;
        }

        .resource-icon {
            background: rgba(85, 239, 196, 0.2);
            color: var(--success);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .resource-content h3 {
            font-size: 1rem;
            margin-bottom: 4px;
            color: var(--text);
        }

        .resource-content p {
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
            margin-bottom: 6px;
        }

        .resource-content a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .resource-content a:hover {
            text-decoration: underline;
        }

        .chart-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--container-shadow);
            margin-top: 15px;
            height: 320px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .mood-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .mood-btn {
            flex: 1;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .mood-btn.selected {
            border-color: var(--secondary);
            background: rgba(162, 155, 254, 0.2);
            box-shadow: 0 4px 15px rgba(162, 155, 254, 0.3);
        }

        .mood-btn i {
            font-size: 28px;
            margin-bottom: 10px;
            display: block;
        }

        .mood-btn span {
            display: block;
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
            margin-top: 6px;
        }

        .action-plan {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--container-shadow);
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .action-plan h3 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-plan h3 i {
            color: var(--primary);
            font-size: 18px;
        }

        .action-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .action-item:last-child {
            border-bottom: none;
        }

        .action-check {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            transition: var(--transition);
            cursor: pointer;
        }

        .action-check.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .action-text h4 {
            margin-bottom: 4px;
            color: var(--text);
        }

        .action-text p {
            color: var(--text);
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .feedback-form {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .feedback-form textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            resize: vertical;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            transition: var(--transition);
        }

        .feedback-form textarea:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .feedback-form button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .feedback-form button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 111, 145, 0.4);
        }

        footer {
            text-align: center;
            padding: 15px;
            font-size: 0.8rem;
            color: var(--text);
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .disclaimer {
            background: rgba(255, 118, 117, 0.1);
            border: 1px solid rgba(255, 118, 117, 0.2);
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
        }

        .emoji-burst {
            position: absolute;
            font-size: 20px;
            animation: emojiPop 1s ease forwards;
        }

        @keyframes emojiPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }

        .mascot {
            position: absolute;
            bottom: 80px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: url("https://img.icons8.com/emoji/48/000000/smiling-face-with-heart-eyes.png") no-repeat center;
            background-size: contain;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
            .container, .auth-container {
                height: 100vh;
                border-radius: 0;
            }

            .sidebar {
                width: 60px;
            }

            .nav-item span {
                display: none;
            }

            .nav-item i {
                margin-right: 0;
                font-size: 22px;
            }

            .message {
                max-width: 85%;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .mood-selector {
                flex-direction: column;
            }

            .language-selector {
                font-size: 0.8rem;
                padding: 6px 8px;
            }

            .mascot {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="auth-container" id="auth-container">
        <h2 class="auth-title">Welcome to MindAid Pro</h2>
        <div class="auth-form" id="login-form">
            <input type="email" id="login-email" placeholder="Email" required aria-label="Email">
            <input type="password" id="login-password" placeholder="Password" required aria-label="Password">
            <button id="login-btn">Login</button>
            <div class="auth-toggle" id="toggle-to-register">Don't have an account? Register</div>
        </div>
        <div class="auth-form" id="register-form" style="display: none;">
            <input type="email" id="register-email" placeholder="Email" required aria-label="Email">
            <input type="password" id="register-password" placeholder="Password" required aria-label="Password">
            <input type="password" id="confirm-password" placeholder="Confirm Password" required aria-label="Confirm Password">
            <button id="register-btn">Register</button>
            <div class="auth-toggle" id="toggle-to-login">Already have an account? Login</div>
        </div>
    </div>

    <div class="container" id="main-app" style="display: none;">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="bx bx-heart"></i>
                </div>
                <div class="logo-text">
                    <h1>MindAid Pro</h1>
                    <div class="subtitle">Mental Health First Aid Assistant</div>
                </div>
            </div>
            <div class="user-controls">
                <select class="language-selector" id="language-selector" aria-label="Select Language">
                    <option value="english">English</option>
                    <option value="hinglish">Hinglish</option>
                    <option value="tanglish">Tanglish</option>
                </select>
                <button class="user-btn" title="Notifications" aria-label="Notifications">
                    <i class="bx bx-bell"></i>
                </button>
                <button class="user-btn" title="Settings" aria-label="Settings">
                    <i class="bx bx-cog"></i>
                </button>
                <button class="user-btn" title="User Profile" aria-label="User Profile">
                    <i class="bx bx-user"></i>
                </button>
                <button class="user-btn" id="logout-btn" title="Logout" aria-label="Logout">
                    <i class="bx bx-log-out"></i>
                </button>
            </div>
        </header>

        <div class="app-body">
            <nav class="sidebar">
                <a href="#" class="nav-item active" data-tab="chat" aria-label="Chat Support">
                    <i class="bx bx-message-dots"></i>
                    <span>Chat Support</span>
                </a>
                <a href="#" class="nav-item" data-tab="mood" aria-label="Mood Tracker">
                    <i class="bx bx-line-chart"></i>
                    <span>Mood Tracker</span>
                </a>
                <a href="#" class="nav-item" data-tab="resources" aria-label="Resources">
                    <i class="bx bx-book"></i>
                    <span>Resources</span>
                </a>
                <a href="#" class="nav-item" data-tab="plan" aria-label="Action Plan">
                    <i class="bx bx-task"></i>
                    <span>Action Plan</span>
                </a>
                <a href="#" class="nav-item" data-tab="emergency" aria-label="Emergency">
                    <i class="bx bx-shield"></i>
                    <span>Emergency</span>
                </a>
                <a href="#" class="nav-item" data-tab="feedback" aria-label="Feedback">
                    <i class="bx bx-comment"></i>
                    <span>Feedback</span>
                </a>
            </nav>

            <div class="main-content">
                <!-- Chat Support Tab -->
                <section class="tab-content active" id="chat-tab">
                    <h2 class="tab-title"><i class="bx bx-message-dots"></i> Mental Health Support</h2>
                    <div class="motivational">"You are stronger than you know, and every step counts! üåü"</div>
                    <p>Chat with MindAid to get immediate support, coping strategies, and resources tailored to your needs.</p>

                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages">
                            <div class="message bot-message" id="initial-message">
                                <span class="message-time">Today, 02:38 PM</span>
                            </div>
                            <div class="quick-replies" id="quick-replies"></div>
                        </div>
                        <div class="mascot"></div>
                        <div class="input-container">
                            <input type="text" id="user-input" placeholder="Type your message here..." autocomplete="off" aria-label="Type your message">
                            <button class="chat-btn" id="send-btn" aria-label="Send Message">
                                <i class="bx bx-send"></i>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Mood Tracker Tab -->
                <section class="tab-content" id="mood-tab">
                    <h2 class="tab-title"><i class="bx bx-line-chart"></i> Mood Tracker</h2>
                    <div class="motivational">"Every day is a new opportunity to nurture your inner peace! üåà"</div>
                    <p>Track your emotional well-being over time to identify patterns and triggers.</p>

                    <div class="mood-selector">
                        <button class="mood-btn" data-mood="excellent" aria-label="Mood: Excellent">
                            <i class="bx bx-happy-alt"></i>
                            Excellent
                            <span>Feeling great!</span>
                        </button>
                        <button class="mood-btn" data-mood="good" aria-label="Mood: Good">
                            <i class="bx bx-smile"></i>
                            Good
                            <span>Pretty good day</span>
                        </button>
                        <button class="mood-btn" data-mood="neutral" aria-label="Mood: Neutral">
                            <i class="bx bx-meh"></i>
                            Neutral
                            <span>Just okay</span>
                        </button>
                        <button class="mood-btn" data-mood="poor" aria-label="Mood: Poor">
                            <i class="bx bx-sad"></i>
                            Poor
                            <span>Not feeling great</span>
                        </button>
                        <button class="mood-btn" data-mood="terrible" aria-label="Mood: Terrible">
                            <i class="bx bx-sad"></i>
                            Terrible
                            <span>Really struggling</span>
                        </button>
                    </div>

                    <div class="chart-container">
                        <canvas id="mood-chart" aria-label="Mood Chart"></canvas>
                    </div>
                </section>

                <!-- Resources Tab -->
                <section class="tab-content" id="resources-tab">
                    <h2 class="tab-title"><i class="bx bx-book"></i> Mental Health Resources</h2>
                    <div class="motivational">"You are never alone in your journey! ü§ù"</div>
                    <p>Access curated resources, tools, and professional support options.</p>

                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-support"></i>
                                Crisis Support
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-phone"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Vandrevala Foundation</h3>
                                        <p>24/7 mental health helpline</p>
                                        <a href="#" aria-label="Call Vandrevala Foundation">Call 9999666555 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-message"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>AASRA Suicide Prevention</h3>
                                        <p>24/7 crisis support</p>
                                        <a href="#" aria-label="Call AASRA Suicide Prevention">Call +91-9820466726 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-globe"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>iCall Helpline</h3>
                                        <p>Psychological support by TISS</p>
                                        <a href="#" aria-label="Call iCall Helpline">Call +91-9152987821 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-book-open"></i>
                                Self-Help Resources
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-file"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>CBT Thought Diary</h3>
                                        <p>Track thoughts and challenge cognitive distortions</p>
                                        <a href="#" aria-label="Download CBT Thought Diary">Download Template <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-headphone"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Guided Meditations</h3>
                                        <p>Mindfulness and relaxation exercises</p>
                                        <a href="#" aria-label="Listen to Guided Meditations">Listen Now <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-video"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Mental Health Webinars</h3>
                                        <p>Free educational sessions from experts</p>
                                        <a href="#" aria-label="View Mental Health Webinars Schedule">View Schedule <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-health"></i>
                                Professional Help
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-search"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Therapist Directory</h3>
                                        <p>Find licensed professionals near you</p>
                                        <a href="#" aria-label="Search Therapist Directory">Search Now <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-laptop"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Online Therapy</h3>
                                        <p>Connect with therapists remotely</p>
                                        <a href="#" aria-label="Start Online Therapy">Get Started <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-group"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Support Groups</h3>
                                        <p>Connect with others facing similar challenges</p>
                                        <a href="#" aria-label="Find Support Groups">Find Groups <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Action Plan Tab -->
                <section class="tab-content" id="plan-tab">
                    <h2 class="tab-title"><i class="bx bx-task"></i> Personalized Action Plan</h2>
                    <div class="motivational">"Small steps today lead to big victories tomorrow! üöÄ"</div>
                    <p>Your step-by-step plan to improve mental wellness based on our conversations.</p>

                    <div class="action-plan">
                        <h3><i class="bx bx-task"></i> This Week's Goals</h3>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Practice deep breathing</h4>
                                <p>5 minutes of mindful breathing each morning</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Connect with a friend</h4>
                                <p>Reach out to someone you trust this week</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Physical activity</h4>
                                <p>20 minutes of movement at least 3 times this week</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Gratitude journal</h4>
                                <p>Write down 3 things you're grateful for each evening</p>
                            </div>
                        </div>
                    </div>

                    <div class="action-plan">
                        <h3><i class="bx bx-book-open"></i> Recommended Resources</h3>
                        <div class="resource-item">
                            <div class="resource-icon">
                                <i class="bx bx-book"></i>
                            </div>
                            <div class="resource-content">
                                <h3>"Feeling Good" by Dr. David Burns</h3>
                                <p>Cognitive behavioral therapy techniques for depression</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <div class="resource-icon">
                                <i class="bx bx-headphone"></i>
                            </div>
                            <div class="resource-content">
                                <h3>Anxiety Relief Meditation</h3>
                                <p>15-minute guided session for immediate calm</p>
                                <a href="#" aria-label="Listen to Anxiety Relief Meditation">Listen Now <i class="bx bx-right-arrow-alt"></i></a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Emergency Tab -->
                <section class="tab-content" id="emergency-tab">
                    <h2 class="tab-title"><i class="bx bx-shield"></i> Emergency Support</h2>
                    <div class="motivational">"You are enough, and help is always available! üíñ"</div>
                    <p>Immediate resources and contacts for crisis situations.</p>

                    <div class="crisis-alert">
                        <h3>If you're in immediate danger:</h3>
                        <p>Call 112 or go to your nearest emergency room</p>
                    </div>

                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-phone"></i>
                                Emergency Contacts
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Vandrevala Foundation</h3>
                                        <p>Call 9999666555</p>
                                        <a href="#" aria-label="Visit Vandrevala Foundation">vandrevalafoundation.com</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>AASRA Suicide Prevention</h3>
                                        <p>Call +91-9820466726</p>
                                        <a href="#" aria-label="Visit AASRA">aasra.info</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>iCall Helpline</h3>
                                        <p>Call +91-9152987821</p>
                                        <a href="#" aria-label="Visit iCall Helpline">icallhelpline.org</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-globe"></i>
                                Additional Resources
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Sangath</h3>
                                        <p>Mental health support services</p>
                                        <a href="#" aria-label="Visit Sangath">sangath.in</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Mpower Helpline</h3>
                                        <p>Call 1800-120-820050</p>
                                        <a href="#" aria-label="Visit Mpower">mpower.org.in</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="disclaimer">
                        <p><strong>Important:</strong> MindAid is not a substitute for professional mental health care. In crisis situations, please contact emergency services or a crisis hotline immediately.</p>
                    </div>
                </section>

                <!-- Feedback Tab -->
                <section class="tab-content" id="feedback-tab">
                    <h2 class="tab-title"><i class="bx bx-comment"></i> Feedback</h2>
                    <div class="motivational">"Your feedback helps us grow and serve you better! üìù"</div>
                    <p>We value your input to improve MindAid Pro. Please share your thoughts below.</p>

                    <div class="feedback-form">
                        <textarea id="feedback-text" placeholder="Share your feedback or suggestions..." required aria-label="Feedback"></textarea>
                        <button id="feedback-submit" aria-label="Submit Feedback">Submit Feedback</button>
                    </div>
                </section>
            </div>
        </div>

        <footer>
            <p>MindAid Pro - Mental Health First Aid Assistant | This is a demonstration project only</p>
            <p>Note: Conversations are not stored or monitored. In real crisis situations, please contact professionals immediately.</p>
        </footer>
    </div>

    <script>
        (function () {
            // State Management
            let state = {
                isAuthenticated: false,
                currentUser: null,
                currentLanguage: localStorage.getItem("language") || "english",
                users: JSON.parse(localStorage.getItem("users")) || {},
                moodData: JSON.parse(localStorage.getItem("moodData")) || {},
                moodChart: null,
            };

            // Language Data
            const languageData = {
                english: {
                    initialMessages: [
                        "Hi there! I'm MindAid, your mental health buddy. üåü<br>How can I help you today?",
                        "Feel free to type how you're feeling or use the quick buttons to get started. What's on your mind?",
                    ],
                    quickReplies: [
                        { text: "I'm feeling anxious üò∞", value: "I'm feeling anxious" },
                        { text: "I'm feeling low üòî", value: "I'm feeling low" },
                        { text: "I'm stressed out üò•", value: "I'm stressed out" },
                        { text: "I need coping tips", value: "I need coping tips" },
                    ],
                    crisisResponse: "You're not alone, and help is here. Would you like assistance in reaching out to any of these resources?",
                    copingStrategies: {
                        anxiety: [
                            "Try deep breathing: Inhale for 4 seconds, hold for 7, exhale for 8. Repeat 5 times. üå¨Ô∏è",
                            "Use the 5-4-3-2-1 technique: Name 5 things you see, 4 you can touch, 3 you hear, 2 you smell, and 1 you taste. üëÄ",
                            "Take a short walk in a park or garden to clear your mind. üå≥",
                            "Jot down your worries in a notebook to organize your thoughts. üìù",
                        ],
                        depression: [
                            "Reach out to a close friend or family member for a chat. üìû",
                            "Do something you enjoy, like listening to music or sketching, for 5 minutes. üé∂",
                            "Say kind words to yourself, like you would to a dear friend. üíñ",
                            "Set a small goal, like making a cup of tea or coffee. ‚òï",
                        ],
                        stress: [
                            "Break your tasks into smaller steps. What's one thing you can do now? üìã",
                            "Try a 5-minute stretch to ease physical tension. ü§∏",
                            "Make a quick to-do list to feel more in control. ‚úÖ",
                            "Sip a calming drink like herbal tea to relax. üçµ",
                        ],
                        sleep: [
                            "Create a bedtime routine, like reading or drinking warm milk. üìñ",
                            "Keep your room cool and cozy with soft bedding. üõå",
                            "Skip caffeine after the afternoon. ‚òï",
                            "Listen to calm music before sleeping. üé∂",
                        ],
                        relationships: [
                            "Listen actively when talking to loved ones, without interrupting. üëÇ",
                            "Use 'I feel' statements to share your emotions clearly. üí¨",
                            "Spend quality time with family or friends, like during meals. üçΩÔ∏è",
                            "Handle conflicts calmly, respecting everyone's views. ü§ù",
                        ],
                    },
                    responses: {
                        anxiety: "I hear you're feeling anxious. It's okay, we can work through this together. Want to try some calming techniques? üåà",
                        depression: "Feeling low can be really tough. Let's take it one step at a time. Would you like a suggestion to lift your mood? üí°",
                        stress: "Stress can feel heavy, I get it. What's got you so overwhelmed? Let's talk about it. ü§ó",
                        sleep: "Trouble sleeping can make things harder. Want some tips to help you rest better? üåô",
                        relationships: "Relationships can be complex. I'm here to listen. What's going on with you? üíû",
                        coping: "Let's explore some coping strategies to help you feel better: ‚ú®",
                        thanks: "Glad I could help! You're doing great, keep it up. üåü",
                        thanksFollowUp: "Want to check out more tips or resources? üìö",
                        generic: [
                            "Thanks for sharing. Want to tell me more about what's going on? ü§î",
                            "I appreciate you opening up. How's this affecting your day-to-day? üó£Ô∏è",
                            "I'm all ears. What's something else you want to talk about? üëÇ",
                            "Sounds like a lot. What do you think might help right now? üí≠",
                            "Let's figure this out together. What's next? üöÄ",
                        ],
                    },
                },
                hinglish: {
                    initialMessages: [
                        "Namaste dost! Main hoon MindAid, tera mental health buddy. üå∏<br>Aaj kaisa feel kar raha hai, kya help chahiye?",
                        "Jo bhi dil mein hai, type kar ya quick buttons se shuru kar. Kya chal raha hai, mujhe bata?",
                    ],
                    quickReplies: [
                        { text: "Mujhe ghabrahat ho rahi hai üò∞", value: "I'm feeling anxious" },
                        { text: "Dil thoda udaas hai üòî", value: "I'm feeling low" },
                        { text: "Bohot tension mein hoon üò•", value: "I'm stressed out" },
                        { text: "Mujhe kuch tips do", value: "I need coping tips" },
                    ],
                    crisisResponse: "Arre, tu bilkul akela nahi hai, yaar. In resources mein se kisi se baat karna chahega kya?",
                    copingStrategies: {
                        anxiety: [
                            "Thoda sa deep breathing try kar: 4 second saans le, 7 second hold kar, 8 second saans chhod. 5 baar repeat kar. üå¨Ô∏è",
                            "5-4-3-2-1 technique use kar: 5 cheezein dekh, 4 ko chhu, 3 sune, 2 smell kar, aur 1 taste kar. üëÄ",
                            "Park mein thodi der walk kar, dimag fresh ho jayega. üå≥",
                            "Apne worries ko ek diary mein likh, dil halka ho jayega. üìù",
                        ],
                        depression: [
                            "Kisi dost ya family wale se dil ki baat share kar. üìû",
                            "Kuch pasand ka kaam kar, jaise 5 minute ke liye gaana sun ya drawing kar. üé∂",
                            "Khud se pyar bhari baat kar, jaise ek dost se karta hai. üíñ",
                            "Ek chhota goal set kar, jaise chai ya coffee banani hai. ‚òï",
                        ],
                        stress: [
                            "Apne kaam ko chhote steps mein baant le. Abhi kya ek kaam ho sakta hai? üìã",
                            "5 minute ka stretch kar, body relax ho jayegi. ü§∏",
                            "Ek chhoti to-do list bana, sab control mein lagega. ‚úÖ",
                            "Thodi si herbal chai pi, thoda sukoon milega. üçµ",
                        ],
                        sleep: [
                            "Raat ka ek routine bana, jaise kitab padh ya garam doodh pi. üìñ",
                            "Apna room thanda aur cozy rakh, soft chadar daal ke. üõå",
                            "Shaam ke baad chai ya coffee avoid kar. ‚òï",
                            "Thoda soft music sun, neend aane mein madad hogi. üé∂",
                        ],
                        relationships: [
                            "Apne pyaron ke saath baat karte waqt poori dhyan se sun. üëÇ",
                            "'Mujhe aisa lagta hai' bolke apne feelings share kar. üí¨",
                            "Family ya doston ke saath khana khaate waqt quality time spend kar. üçΩÔ∏è",
                            "Agar jhagda ho, to shaanti se baat kar, sabki izzat rakh ke. ü§ù",
                        ],
                    },
                    responses: {
                        anxiety: "Arre, ghabrahat ho rahi hai? Koi baat nahi, hum saath mein handle kar lenge. Kuch calming tips try karein? üåà",
                        depression: "Dil udaas hai, samajh gaya. Ek-ek kadam chalte hain. Mood thoda better karne ka idea doon? üí°",
                        stress: "Tension toh banta hai, yaar. Kya cheez zyada pareshan kar rahi hai? Baat karte hain. ü§ó",
                        sleep: "Neend nahi aa rahi? Chalo, better sleep ke liye kuch tips dete hain. üåô",
                        relationships: "Rishton ka chakkar hai, samajh gaya. Kya ho raha hai, thoda aur bata? üíû",
                        coping: "Chalo, kuch naye coping ideas dekhte hain jo dil ko sukoon de: ‚ú®",
                        thanks: "Shukriya, dost! Tu bohot achha kar raha hai, aise hi continue kar. üåü",
                        thanksFollowUp: "Aur koi tip ya resource dekhna hai kya? üìö",
                        generic: [
                            "Dil khol ke batane ke liye shukriya. Aur kya chal raha hai, thoda aur bata? ü§î",
                            "Teri baat sunke achha laga. Yeh roz ki zindagi pe kaisa asar daal raha hai? üó£Ô∏è",
                            "Main sun raha hoon. Aur kya baat karni hai? üëÇ",
                            "Thoda heavy lag raha hai. Abhi kya karna chahiye, kya sochta hai? üí≠",
                            "Chalo, saath mein iska kuch karte hain. Agla step kya hai? üöÄ",
                        ],
                    },
                },
                tanglish: {
                    initialMessages: [
                        "Vanakkam machi! Naan MindAid, un mental health dostu. üòä<br>Innaiku eppadi irukka, enna help venum?",
                        "Manasula enna irukku, type pannu illa quick buttons press pannu. Enna nadakkuthu, sollu pa!",
                    ],
                    quickReplies: [
                        { text: "Enakku bayama irukku üò∞", value: "I'm feeling anxious" },
                        { text: "Manasu downa irukku üòî", value: "I'm feeling low" },
                        { text: "Romba pressurea irukku üò•", value: "I'm stressed out" },
                        { text: "Konjam tips venum", value: "I need coping tips" },
                    ],
                    crisisResponse: "Machi, nee thaniya illa, namba irukkom. Intha resources-la yaarukittaiyavathu pesanuma?",
                    copingStrategies: {
                        anxiety: [
                            "Deep breathing pannu: 4 seconds saans edu, 7 seconds hold pannu, 8 seconds velila vidu. 5 thadava pannu. üå¨Ô∏è",
                            "5-4-3-2-1 technique try pannu: 5 paakuren, 4 thotturen, 3 ketkuren, 2 vaasanai pannuren, 1 taste pannuren. üëÄ",
                            "Park-la konjam nadanthu vaa, manasu konjam fresh aagum. üå≥",
                            "Un tension-a notebook-la ezhuthu, konjam clear aagum da. üìù",
                        ],
                        depression: [
                            "Nalla friend-a illa family-a konjam pesu, manasu light aagum. üìû",
                            "Unakku pudicha paattu kettu illa 5 minute sketch pannu, mood konjam maaraum. üé∂",
                            "Unna nee nalla friend maari encourage pannu, 'Nee super da' nu sollu. üíñ",
                            "Chinna goal vachuko, filter coffee pannurathu maari. ‚òï",
                        ],
                        stress: [
                            "Vela-ya chinnachinna steps-a pannu. Ippo enna pannalam? üìã",
                            "5 minute stretch pannu, body relax aagum da. ü§∏",
                            "Quick to-do list pannu, ellam control-la irukum. ‚úÖ",
                            "Tulsi tea kudichu, konjam chill pannu. üçµ",
                        ],
                        sleep: [
                            "Night routine pannu, paal kudichu illa konjam book padichu thoongu. üìñ",
                            "Room-a cool-a vechuko, soft bed sheet podu. üõå",
                            "Evening coffee illa tea kudikkaatha, thoonga mudiyum. ‚òï",
                            "Soft Tamil paatu kettu, thoongurathukku munna. üé∂",
                        ],
                        relationships: [
                            "Pesumpo nalla ketu, friend-a illa family-a irunthaalum. üëÇ",
                            "'Enakku ippadi thonuthu' nu sollu, confusion varathu. üí¨",
                            "Family illa friends kuda sapadu time-la nalla iru. üçΩÔ∏è",
                            "Problem na calm-a solve pannu, ellaroda feelings respect pannu. ü§ù",
                        ],
                    },
                    responses: {
                        anxiety: "Bayama irukku nu solra, sari da. Namma saathu paakalam. Konjam tips venuma? üåà",
                        depression: "Manasu downa irukku, paavam. Chinnachinna steps edukkalaam, idea venuma? üí°",
                        stress: "Pressure romba irukku nu solra, machi. Enna matter, konjam pesalaam? ü§ó",
                        sleep: "Thoongala illa? Konjam help pannalam, nalla thoonga tips venuma? üåô",
                        relationships: "Relationship vishayam thaan, sari. Innum konjam sollu, enna nadakkuthu? üíû",
                        coping: "Vaa, konjam nalla coping tips paakalam: ‚ú®",
                        thanks: "Nandri da, machi! Nee super pannura, ippadiye continue pannu. üåü",
                        thanksFollowUp: "Innum ethavathu tips illa resources paaklama? üìö",
                        generic: [
                            "Sollu, manasula enna irukku, konjam share pannu paakalam. ü§î",
                            "Un baat kekka nalla irukku. Idhu daily life-a eppadi paathukuthu? üó£Ô∏è",
                            "Naan irukken, vera enna pesalam sollu? üëÇ",
                            "Konjam kastama irukku, aana manage pannalam. Next enna pannalam? üí≠",
                            "Vaa, saathu konjam ideas paakalam! üöÄ",
                        ],
                    },
                },
            };

            // Crisis Detection
            const crisisConfig = {
                keywords: [
                    "suicide",
                    "kill myself",
                    "end my life",
                    "want to die",
                    "harm myself",
                    "self-harm",
                    "hopeless",
                    "no point",
                    "give up",
                    "cannot go on",
                    "worthless",
                ],
                resources: [
                    "Vandrevala Foundation: <strong>Call 9999666555</strong>",
                    "AASRA Suicide Prevention: <strong>Call +91-9820466726</strong>",
                    "iCall Helpline: <strong>Call +91-9152987821</strong>",
                    "Mpower Emergency: <strong>Call 1800-120-820050</strong>",
                    "Emergency Services: <strong>112</strong>",
                ],
            };

            // DOM Elements
            const elements = {
                authContainer: document.getElementById("auth-container"),
                mainApp: document.getElementById("main-app"),
                loginForm: document.getElementById("login-form"),
                registerForm: document.getElementById("register-form"),
                toggleToRegister: document.getElementById("toggle-to-register"),
                toggleToLogin: document.getElementById("toggle-to-login"),
                logoutBtn: document.getElementById("logout-btn"),
                languageSelector: document.getElementById("language-selector"),
                chatContainer: document.getElementById("chat-messages"),
                quickRepliesContainer: document.getElementById("quick-replies"),
                userInput: document.getElementById("user-input"),
                sendBtn: document.getElementById("send-btn"),
                tabLinks: document.querySelectorAll(".nav-item"),
                tabContents: document.querySelectorAll(".tab-content"),
                moodButtons: document.querySelectorAll(".mood-btn"),
                actionChecks: document.querySelectorAll(".action-check"),
                feedbackSubmit: document.getElementById("feedback-submit"),
                feedbackText: document.getElementById("feedback-text"),
            };

            // Utility Functions
            const utils = {
                formatTime: (date) =>
                    date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }),
                triggerConfetti: () =>
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 },
                        colors: ["#ff6f91", "#a29bfe", "#feca57"],
                    }),
                triggerEmojiBurst: (container, emojis) => {
                    for (let i = 0; i < 5; i++) {
                        const emoji = document.createElement("span");
                        emoji.classList.add("emoji-burst");
                        emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                        emoji.style.left = `${Math.random() * 100}%`;
                        emoji.style.top = `${Math.random() * 100}%`;
                        container.appendChild(emoji);
                    }
                },
                addMessage: (text, isUser = false) => {
                    const messageDiv = document.createElement("div");
                    messageDiv.classList.add("message", isUser ? "user-message" : "bot-message");
                    const now = new Date();
                    messageDiv.innerHTML = `${text}<span class="message-time">${utils.formatTime(now)}</span>`;
                    elements.chatContainer.appendChild(messageDiv);
                    elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;
                },
                showTyping: () => {
                    const typingDiv = document.createElement("div");
                    typingDiv.classList.add("typing-indicator");
                    typingDiv.id = "typing-indicator";
                    typingDiv.innerHTML = `
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                        <span class="typing-dot"></span>
                    `;
                    elements.chatContainer.appendChild(typingDiv);
                    elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;
                    return typingDiv;
                },
                hideTyping: () => {
                    const typingIndicator = document.getElementById("typing-indicator");
                    if (typingIndicator) typingIndicator.remove();
                },
            };

            // Authentication
            const auth = {
                initialize: () => {
                    if (localStorage.getItem("currentUser")) {
                        state.isAuthenticated = true;
                        state.currentUser = localStorage.getItem("currentUser");
                        elements.authContainer.style.display = "none";
                        elements.mainApp.style.display = "flex";
                        utils.triggerConfetti();
                        app.initializeMoodChart();
                        app.updateChatLanguage();
                    }
                },
                login: () => {
                    const email = document.getElementById("login-email").value;
                    const password = document.getElementById("login-password").value;
                    if (state.users[email] && state.users[email].password === password) {
                        state.isAuthenticated = true;
                        state.currentUser = email;
                        localStorage.setItem("currentUser", email);
                        elements.authContainer.style.display = "none";
                        elements.mainApp.style.display = "flex";
                        app.initializeMoodChart();
                        app.updateChatLanguage();
                        utils.triggerConfetti();
                    } else {
                        alert("Invalid email or password!");
                    }
                },
                register: () => {
                    const email = document.getElementById("register-email").value;
                    const password = document.getElementById("register-password").value;
                    const confirmPassword = document.getElementById("confirm-password").value;
                    if (password !== confirmPassword) {
                        alert("Passwords do not match!");
                        return;
                    }
                    if (state.users[email]) {
                        alert("User already exists!");
                        return;
                    }
                    state.users[email] = { password, moods: [] };
                    localStorage.setItem("users", JSON.stringify(state.users));
                    alert("Registration successful! Please login.");
                    elements.loginForm.style.display = "flex";
                    elements.registerForm.style.display = "none";
                },
                logout: () => {
                    state.isAuthenticated = false;
                    state.currentUser = null;
                    localStorage.removeItem("currentUser");
                    elements.authContainer.style.display = "flex";
                    elements.mainApp.style.display = "none";
                    elements.loginForm.style.display = "flex";
                    elements.registerForm.style.display = "none";
                },
            };

            // Main App Logic
            const app = {
                initializeMoodChart: () => {
                    const moodCtx = document.getElementById("mood-chart").getContext("2d");
                    const userMoods = state.moodData[state.currentUser] || [];
                    const labels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
                    const data = Array(7).fill(null);

                    userMoods.forEach((mood) => {
                        const date = new Date(mood.date);
                        const dayIndex = date.getDay() === 0 ? 6 : date.getDay() - 1;
                        data[dayIndex] = mood.value;
                    });

                    state.moodChart = new Chart(moodCtx, {
                        type: "line",
                        data: {
                            labels,
                            datasets: [
                                {
                                    label: "Mood Level",
                                    data,
                                    borderColor: "#ff6f91",
                                    backgroundColor: "rgba(255, 111, 145, 0.1)",
                                    borderWidth: 3,
                                    pointRadius: 6,
                                    pointBackgroundColor: "#ff6f91",
                                    tension: 0.3,
                                    fill: true,
                                },
                            ],
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    min: 1,
                                    max: 5,
                                    ticks: {
                                        callback: (value) => {
                                            const moods = ["Terrible", "Poor", "Neutral", "Good", "Excellent"];
                                            return moods[value - 1];
                                        },
                                    },
                                },
                            },
                            plugins: {
                                legend: { display: false },
                                tooltip: {
                                    callbacks: {
                                        label: (context) => {
                                            const moods = ["Terrible", "Poor", "Neutral", "Good", "Excellent"];
                                            return context.parsed.y ? moods[context.parsed.y - 1] : "No data";
                                        },
                                    },
                                },
                            },
                        },
                    });
                },
                updateChatLanguage: () => {
                    const lang = languageData[state.currentLanguage];
                    elements.quickRepliesContainer.innerHTML = "";
                    lang.quickReplies.forEach((reply) => {
                        const button = document.createElement("button");
                        button.classList.add("quick-reply");
                        button.setAttribute("data-reply", reply.value);
                        button.textContent = reply.text;
                        button.setAttribute("aria-label", reply.text);
                        elements.quickRepliesContainer.appendChild(button);
                    });

                    const initialMessageDiv = document.getElementById("initial-message");
                    const now = new Date();
                    initialMessageDiv.innerHTML = `${lang.initialMessages[0]}<span class="message-time">${utils.formatTime(now)}</span>`;

                    document.querySelectorAll(".quick-reply").forEach((button) => {
                        button.addEventListener("click", function () {
                            const reply = this.getAttribute("data-reply");
                            utils.addMessage(this.textContent, true);
                            const typingIndicator = utils.showTyping();
                            chat.generateResponse(reply);
                            utils.triggerEmojiBurst(elements.chatContainer, ["üòä", "üåü", "üíñ"]);
                        });
                    });
                },
            };

            // Chat Logic
            const chat = {
                generateResponse: (userMessage) => {
                    const lowerMsg = userMessage.toLowerCase();
                    const lang = languageData[state.currentLanguage];
                    const hasCrisis = crisisConfig.keywords.some((keyword) => lowerMsg.includes(keyword));

                    if (hasCrisis) {
                        setTimeout(() => {
                            utils.hideTyping();
                            const alertDiv = document.createElement("div");
                            alertDiv.classList.add("crisis-alert");
                            alertDiv.innerHTML = `
                                <strong>‚ö†Ô∏è Crisis Detected</strong><br>
                                Your message suggests you might be in crisis. Please reach out to these resources immediately:
                            `;
                            const resourcesDiv = document.createElement("div");
                            resourcesDiv.classList.add("resources-card");
                            resourcesDiv.innerHTML = crisisConfig.resources.join("<br />");
                            elements.chatContainer.appendChild(alertDiv);
                            elements.chatContainer.appendChild(resourcesDiv);
                            elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;

                            setTimeout(() => {
                                utils.addMessage(lang.crisisResponse);
                            }, 1000);
                        }, 1500);
                        return;
                    }

                    setTimeout(() => {
                        utils.hideTyping();
                        if (lowerMsg.includes("anxious") || lowerMsg.includes("ghabrahat") || lowerMsg.includes("bayama")) {
                            utils.addMessage(lang.responses.anxiety);
                            chat.sendCopingTips(lang.copingStrategies.anxiety, lang.responses);
                        } else if (lowerMsg.includes("low") || lowerMsg.includes("udaas") || lowerMsg.includes("downa")) {
                            utils.addMessage(lang.responses.depression);
                            chat.sendCopingTips(lang.copingStrategies.depression, lang.responses);
                        } else if (lowerMsg.includes("stress") || lowerMsg.includes("tension") || lowerMsg.includes("pressure")) {
                            utils.addMessage(lang.responses.stress);
                            chat.sendCopingTips(lang.copingStrategies.stress, lang.responses);
                        } else if (lowerMsg.includes("sleep") || lowerMsg.includes("neend") || lowerMsg.includes("thoongala")) {
                            utils.addMessage(lang.responses.sleep);
                            chat.sendCopingTips(lang.copingStrategies.sleep, lang.responses);
                        } else if (lowerMsg.includes("relationship") || lowerMsg.includes("rishton") || lowerMsg.includes("vishayam")) {
                            utils.addMessage(lang.responses.relationships);
                            chat.sendCopingTips(lang.copingStrategies.relationships, lang.responses);
                        } else if (lowerMsg.includes("coping") || lowerMsg.includes("tips") || lowerMsg.includes("venum")) {
                            utils.addMessage(lang.responses.coping);
                            const allTips = Object.values(lang.copingStrategies).flat();
                            const randomTips = allTips.sort(() => 0.5 - Math.random()).slice(0, 4);
                            chat.sendCopingTips(randomTips, lang.responses);
                        } else {
                            const randomResponse = lang.responses.generic[Math.floor(Math.random() * lang.responses.generic.length)];
                            utils.addMessage(randomResponse);
                        }
                    }, 1500);
                },
                sendCopingTips: (tips, responses) => {
                    tips.forEach((tip, index) => {
                        setTimeout(() => {
                            utils.addMessage(tip);
                            if (index === tips.length - 1) {
                                setTimeout(() => {
                                    utils.addMessage(responses.thanks);
                                    setTimeout(() => {
                                        utils.addMessage(responses.thanksFollowUp);
                                    }, 1000);
                                }, 1000);
                            }
                        }, index * 1000);
                    });
                },
            };

            // Event Listeners
            const setupEventListeners = () => {
                elements.toggleToRegister.addEventListener("click", () => {
                    elements.loginForm.style.display = "none";
                    elements.registerForm.style.display = "flex";
                });

                elements.toggleToLogin.addEventListener("click", () => {
                    elements.loginForm.style.display = "flex";
                    elements.registerForm.style.display = "none";
                });

                document.getElementById("register-btn").addEventListener("click", auth.register);
                document.getElementById("login-btn").addEventListener("click", auth.login);
                elements.logoutBtn.addEventListener("click", auth.logout);

                elements.languageSelector.addEventListener("change", () => {
                    state.currentLanguage = elements.languageSelector.value;
                    localStorage.setItem("language", state.currentLanguage);
                    app.updateChatLanguage();
                });

                elements.tabLinks.forEach((link) => {
                    link.addEventListener("click", (e) => {
                        e.preventDefault();
                        if (link.getAttribute("data-tab") === "mood" && !state.isAuthenticated) {
                            alert("Please login to access the Mood Tracker");
                            return;
                        }
                        elements.tabLinks.forEach((l) => l.classList.remove("active"));
                        link.classList.add("active");
                        elements.tabContents.forEach((c) => c.classList.remove("active"));
                        document.getElementById(`${link.getAttribute("data-tab")}-tab`).classList.add("active");
                    });
                });
        

            // Initial bot messages
            setTimeout(() => {
                const typingIndicator = showTyping();
                setTimeout(() => {
                    hideTyping();
                    addMessage(languageData[currentLanguage].initialMessages[0]);
                    setTimeout(() => {
                        addMessage(languageData[currentLanguage].initialMessages[1]);
                    }, 800);
                }, 1500);
            }, 1000);
        });
    </script>
</body>
</html>
