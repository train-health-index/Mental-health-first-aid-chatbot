<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MindAid Pro - Your mental health first aid assistant">
    <meta name="author" content="MindAid Team">
    <title>MindAid Pro - Mental Health First Aid</title>
    <!-- Boxicons CDN -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <!-- Poppins Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Confetti.js -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #ff6f91;
            --primary-dark: #e05577;
            --secondary: #a29bfe;
            --secondary-dark: #7f7bff;
            --accent: #feca57;
            --background: #f4e7ff;
            --card-bg: rgba(255, 255, 255, 0.2);
            --text: #2d3436;
            --success: #55efc4;
            --info: #74c0fc;
            --container-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--background) 0%, #ffdeeb 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container, .auth-container {
            width: 100%;
            max-width: 1200px;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: var(--container-shadow);
            border: 1px solid rgba(255, 255, 255, 0.3);
            overflow: hidden;
        }

        .auth-container {
            max-width: 400px;
            padding: 40px;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auth-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--text);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .auth-form input {
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            transition: var(--transition);
        }

        .auth-form input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .auth-form button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .auth-form button:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .auth-toggle {
            color: var(--secondary);
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .auth-toggle:hover {
            color: var(--secondary-dark);
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 95vh;
        }

        header {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-icon i {
            font-size: 20px;
        }

        .logo-text h1 {
            font-size: 1.6rem;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .logo-text .subtitle {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .user-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .user-btn, .chat-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chat-btn {
            background: var(--primary);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .user-btn:hover, .chat-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }

        .chat-btn:hover {
            background: var(--primary-dark);
        }

        .language-selector {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .language-selector:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.3);
        }

        .app-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 240px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            padding: 20px 0;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--text);
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
            border-left: 4px solid transparent;
        }

        .nav-item i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            font-size: 20px;
            color: var(--secondary);
        }

        .nav-item.active, .nav-item:hover {
            background: rgba(162, 155, 254, 0.2);
            color: var(--secondary-dark);
            border-left: 4px solid var(--secondary-dark);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tab-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .motivational {
            background: linear-gradient(45deg, var(--success) 0%, #00b894 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            font-style: italic;
            font-size: 1.1rem;
            box-shadow: 0 4px 15px rgba(85, 239, 196, 0.3);
        }

        .chat-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 75%;
            padding: 12px 18px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bot-message {
            background: rgba(162, 155, 254, 0.2);
            border: 1px solid rgba(162, 155, 254, 0.3);
            border-bottom-left-radius: 4px;
            align-self: flex-start;
        }

        .user-message {
            background: rgba(255, 111, 145, 0.2);
            border-bottom-right-radius: 4px;
            align-self: flex-end;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 6px;
            display: block;
        }

        .typing-indicator {
            display: inline-flex;
            padding: 12px 18px;
            background: rgba(162, 155, 254, 0.2);
            border-radius: 15px;
            border-bottom-left-radius: 4px;
            align-self: flex-start;
            border: 1px solid rgba(162, 155, 254, 0.3);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            margin: 0 3px;
            animation: typing 1.2s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-4px); }
        }

        .crisis-alert {
            background: linear-gradient(90deg, #ff7675 0%, #d63031 100%);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 15px rgba(255, 118, 117, 0.3);
        }

        .resources-card {
            background: var(--info);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(116, 192, 252, 0.3);
        }

        .input-container {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            gap: 10px;
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.05);
        }

        #user-input {
            flex: 1;
            padding: 12px 18px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            outline: none;
            font-size: 0.9rem;
            transition: var(--transition);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
        }

        #user-input:focus {
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .quick-replies {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .quick-reply {
            background: rgba(255, 111, 145, 0.1);
            color: var(--primary);
            border: 1px solid rgba(255, 111, 145, 0.3);
            border-radius: 12px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }

        .quick-reply:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .tab-title {
            font-size: 1.6rem;
            color: var(--text);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tab-title i {
            background: var(--secondary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .card {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--container-shadow);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            padding: 15px;
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-header i {
            color: var(--primary);
            font-size: 18px;
        }

        .card-body {
            padding: 15px;
        }

        .resource-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .resource-item:last-child {
            border-bottom: none;
        }

        .resource-icon {
            background: rgba(85, 239, 196, 0.2);
            color: var(--success);
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .resource-content h3 {
            font-size: 1rem;
            margin-bottom: 4px;
            color: var(--text);
        }

        .resource-content p {
            font-size: 0.9rem;
            color: var(--text);
            opacity: 0.8;
            margin-bottom: 6px;
        }

        .resource-content a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .resource-content a:hover {
            text-decoration: underline;
        }

        .chart-container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--container-shadow);
            margin-top: 15px;
            height: 320px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .mood-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .mood-btn {
            flex: 1;
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .mood-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .mood-btn.selected {
            border-color: var(--secondary);
            background: rgba(162, 155, 254, 0.2);
            box-shadow: 0 4px 15px rgba(162, 155, 254, 0.3);
        }

        .mood-btn i {
            font-size: 28px;
            margin-bottom: 10px;
            display: block;
        }

        .mood-btn span {
            display: block;
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
            margin-top: 6px;
        }

        .action-plan {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--container-shadow);
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .action-plan h3 {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-plan h3 i {
            color: var(--primary);
            font-size: 18px;
        }

        .action-item {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .action-item:last-child {
            border-bottom: none;
        }

        .action-check {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            transition: var(--transition);
            cursor: pointer;
        }

        .action-check.checked {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        .action-text h4 {
            margin-bottom: 4px;
            color: var(--text);
        }

        .action-text p {
            color: var(--text);
            opacity: 0.8;
            font-size: 0.9rem;
        }

        .feedback-form {
            max-width: 500px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .feedback-form textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            resize: vertical;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            transition: var(--transition);
        }

        .feedback-form textarea:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(162, 155, 254, 0.2);
        }

        .feedback-form button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(255, 111, 145, 0.3);
        }

        .feedback-form button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 111, 145, 0.4);
        }

        footer {
            text-align: center;
            padding: 15px;
            font-size: 0.8rem;
            color: var(--text);
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .disclaimer {
            background: rgba(255, 118, 117, 0.1);
            border: 1px solid rgba(255, 118, 117, 0.2);
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: var(--text);
            opacity: 0.8;
        }

        .emoji-burst {
            position: absolute;
            font-size: 20px;
            animation: emojiPop 1s ease forwards;
        }

        @keyframes emojiPop {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.5); opacity: 1; }
            100% { transform: scale(1); opacity: 0; }
        }

        .mascot {
            position: absolute;
            bottom: 80px;
            left: 20px;
            width: 60px;
            height: 60px;
            background: url("https://img.icons8.com/emoji/48/000000/smiling-face-with-heart-eyes.png") no-repeat center;
            background-size: contain;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
            .container, .auth-container {
                height: 100vh;
                border-radius: 0;
            }

            .sidebar {
                width: 60px;
            }

            .nav-item span {
                display: none;
            }

            .nav-item i {
                margin-right: 0;
                font-size: 22px;
            }

            .message {
                max-width: 85%;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .mood-selector {
                flex-direction: column;
            }

            .language-selector {
                font-size: 0.8rem;
                padding: 6px 8px;
            }

            .mascot {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="auth-container" id="auth-container">
        <h2 class="auth-title">Welcome to MindAid Pro</h2>
        <div class="auth-form" id="login-form">
            <input type="email" id="login-email" placeholder="Email" required aria-label="Email">
            <input type="password" id="login-password" placeholder="Password" required aria-label="Password">
            <button id="login-btn">Login</button>
            <div class="auth-toggle" id="toggle-to-register">Don't have an account? Register</div>
        </div>
        <div class="auth-form" id="register-form" style="display: none;">
            <input type="email" id="register-email" placeholder="Email" required aria-label="Email">
            <input type="password" id="register-password" placeholder="Password" required aria-label="Password">
            <input type="password" id="confirm-password" placeholder="Confirm Password" required aria-label="Confirm Password">
            <button id="register-btn">Register</button>
            <div class="auth-toggle" id="toggle-to-login">Already have an account? Login</div>
        </div>
    </div>

    <div class="container" id="main-app" style="display: none;">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="bx bx-heart"></i>
                </div>
                <div class="logo-text">
                    <h1>MindAid Pro</h1>
                    <div class="subtitle">Mental Health First Aid Assistant</div>
                </div>
            </div>
            <div class="user-controls">
                <select class="language-selector" id="language-selector" aria-label="Select Language">
                    <option value="english">English</option>
                    <option value="hinglish">Hinglish</option>
                    <option value="tanglish">Tanglish</option>
                </select>
                <button class="user-btn" title="Notifications" aria-label="Notifications">
                    <i class="bx bx-bell"></i>
                </button>
                <button class="user-btn" title="Settings" aria-label="Settings">
                    <i class="bx bx-cog"></i>
                </button>
                <button class="user-btn" title="User Profile" aria-label="User Profile">
                    <i class="bx bx-user"></i>
                </button>
                <button class="user-btn" id="logout-btn" title="Logout" aria-label="Logout">
                    <i class="bx bx-log-out"></i>
                </button>
            </div>
        </header>

        <div class="app-body">
            <nav class="sidebar">
                <a href="#" class="nav-item active" data-tab="chat" aria-label="Chat Support">
                    <i class="bx bx-message-dots"></i>
                    <span>Chat Support</span>
                </a>
                <a href="#" class="nav-item" data-tab="mood" aria-label="Mood Tracker">
                    <i class="bx bx-line-chart"></i>
                    <span>Mood Tracker</span>
                </a>
                <a href="#" class="nav-item" data-tab="resources" aria-label="Resources">
                    <i class="bx bx-book"></i>
                    <span>Resources</span>
                </a>
                <a href="#" class="nav-item" data-tab="plan" aria-label="Action Plan">
                    <i class="bx bx-task"></i>
                    <span>Action Plan</span>
                </a>
                <a href="#" class="nav-item" data-tab="emergency" aria-label="Emergency">
                    <i class="bx bx-shield"></i>
                    <span>Emergency</span>
                </a>
                <a href="#" class="nav-item" data-tab="feedback" aria-label="Feedback">
                    <i class="bx bx-comment"></i>
                    <span>Feedback</span>
                </a>
            </nav>

            <div class="main-content">
                <!-- Chat Support Tab -->
                <section class="tab-content active" id="chat-tab">
                    <h2 class="tab-title"><i class="bx bx-message-dots"></i> Mental Health Support</h2>
                    <div class="motivational">"You are stronger than you know, and every step counts! 🌟"</div>
                    <p>Chat with MindAid to get immediate support, coping strategies, and resources tailored to your needs.</p>

                    <div class="chat-container">
                        <div class="chat-messages" id="chat-messages">
                            <div class="message bot-message" id="initial-message">
                                <span class="message-time">Today, 02:38 PM</span>
                            </div>
                            <div class="quick-replies" id="quick-replies"></div>
                        </div>
                        <div class="mascot"></div>
                        <div class="input-container">
                            <input type="text" id="user-input" placeholder="Type your message here..." autocomplete="off" aria-label="Type your message">
                            <button class="chat-btn" id="send-btn" aria-label="Send Message">
                                <i class="bx bx-send"></i>
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Mood Tracker Tab -->
                <section class="tab-content" id="mood-tab">
                    <h2 class="tab-title"><i class="bx bx-line-chart"></i> Mood Tracker</h2>
                    <div class="motivational">"Every day is a new opportunity to nurture your inner peace! 🌈"</div>
                    <p>Track your emotional well-being over time to identify patterns and triggers.</p>

                    <div class="mood-selector">
                        <button class="mood-btn" data-mood="excellent" aria-label="Mood: Excellent">
                            <i class="bx bx-happy-alt"></i>
                            Excellent
                            <span>Feeling great!</span>
                        </button>
                        <button class="mood-btn" data-mood="good" aria-label="Mood: Good">
                            <i class="bx bx-smile"></i>
                            Good
                            <span>Pretty good day</span>
                        </button>
                        <button class="mood-btn" data-mood="neutral" aria-label="Mood: Neutral">
                            <i class="bx bx-meh"></i>
                            Neutral
                            <span>Just okay</span>
                        </button>
                        <button class="mood-btn" data-mood="poor" aria-label="Mood: Poor">
                            <i class="bx bx-sad"></i>
                            Poor
                            <span>Not feeling great</span>
                        </button>
                        <button class="mood-btn" data-mood="terrible" aria-label="Mood: Terrible">
                            <i class="bx bx-sad"></i>
                            Terrible
                            <span>Really struggling</span>
                        </button>
                    </div>

                    <div class="chart-container">
                        <canvas id="mood-chart" aria-label="Mood Chart"></canvas>
                    </div>
                </section>

                <!-- Resources Tab -->
                <section class="tab-content" id="resources-tab">
                    <h2 class="tab-title"><i class="bx bx-book"></i> Mental Health Resources</h2>
                    <div class="motivational">"You are never alone in your journey! 🤝"</div>
                    <p>Access curated resources, tools, and professional support options.</p>

                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-support"></i>
                                Crisis Support
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-phone"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Vandrevala Foundation</h3>
                                        <p>24/7 mental health helpline</p>
                                        <a href="#" aria-label="Call Vandrevala Foundation">Call 9999666555 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-message"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>AASRA Suicide Prevention</h3>
                                        <p>24/7 crisis support</p>
                                        <a href="#" aria-label="Call AASRA Suicide Prevention">Call +91-9820466726 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-globe"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>iCall Helpline</h3>
                                        <p>Psychological support by TISS</p>
                                        <a href="#" aria-label="Call iCall Helpline">Call +91-9152987821 <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-book-open"></i>
                                Self-Help Resources
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-file"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>CBT Thought Diary</h3>
                                        <p>Track thoughts and challenge cognitive distortions</p>
                                        <a href="#" aria-label="Download CBT Thought Diary">Download Template <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-headphone"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Guided Meditations</h3>
                                        <p>Mindfulness and relaxation exercises</p>
                                        <a href="#" aria-label="Listen to Guided Meditations">Listen Now <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-video"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Mental Health Webinars</h3>
                                        <p>Free educational sessions from experts</p>
                                        <a href="#" aria-label="View Mental Health Webinars Schedule">View Schedule <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-health"></i>
                                Professional Help
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-search"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Therapist Directory</h3>
                                        <p>Find licensed professionals near you</p>
                                        <a href="#" aria-label="Search Therapist Directory">Search Now <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-laptop"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Online Therapy</h3>
                                        <p>Connect with therapists remotely</p>
                                        <a href="#" aria-label="Start Online Therapy">Get Started <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-icon">
                                        <i class="bx bx-group"></i>
                                    </div>
                                    <div class="resource-content">
                                        <h3>Support Groups</h3>
                                        <p>Connect with others facing similar challenges</p>
                                        <a href="#" aria-label="Find Support Groups">Find Groups <i class="bx bx-right-arrow-alt"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Action Plan Tab -->
                <section class="tab-content" id="plan-tab">
                    <h2 class="tab-title"><i class="bx bx-task"></i> Personalized Action Plan</h2>
                    <div class="motivational">"Small steps today lead to big victories tomorrow! 🚀"</div>
                    <p>Your step-by-step plan to improve mental wellness based on our conversations.</p>

                    <div class="action-plan">
                        <h3><i class="bx bx-task"></i> This Week's Goals</h3>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Practice deep breathing</h4>
                                <p>5 minutes of mindful breathing each morning</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Connect with a friend</h4>
                                <p>Reach out to someone you trust this week</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Physical activity</h4>
                                <p>20 minutes of movement at least 3 times this week</p>
                            </div>
                        </div>
                        <div class="action-item">
                            <div class="action-check" aria-label="Mark as completed">
                                <i class="bx bx-check"></i>
                            </div>
                            <div class="action-text">
                                <h4>Gratitude journal</h4>
                                <p>Write down 3 things you're grateful for each evening</p>
                            </div>
                        </div>
                    </div>

                    <div class="action-plan">
                        <h3><i class="bx bx-book-open"></i> Recommended Resources</h3>
                        <div class="resource-item">
                            <div class="resource-icon">
                                <i class="bx bx-book"></i>
                            </div>
                            <div class="resource-content">
                                <h3>"Feeling Good" by Dr. David Burns</h3>
                                <p>Cognitive behavioral therapy techniques for depression</p>
                            </div>
                        </div>
                        <div class="resource-item">
                            <div class="resource-icon">
                                <i class="bx bx-headphone"></i>
                            </div>
                            <div class="resource-content">
                                <h3>Anxiety Relief Meditation</h3>
                                <p>15-minute guided session for immediate calm</p>
                                <a href="#" aria-label="Listen to Anxiety Relief Meditation">Listen Now <i class="bx bx-right-arrow-alt"></i></a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Emergency Tab -->
                <section class="tab-content" id="emergency-tab">
                    <h2 class="tab-title"><i class="bx bx-shield"></i> Emergency Support</h2>
                    <div class="motivational">"You are enough, and help is always available! 💖"</div>
                    <p>Immediate resources and contacts for crisis situations.</p>

                    <div class="crisis-alert">
                        <h3>If you're in immediate danger:</h3>
                        <p>Call 112 or go to your nearest emergency room</p>
                    </div>

                    <div class="card-grid">
                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-phone"></i>
                                Emergency Contacts
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Vandrevala Foundation</h3>
                                        <p>Call 9999666555</p>
                                        <a href="#" aria-label="Visit Vandrevala Foundation">vandrevalafoundation.com</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>AASRA Suicide Prevention</h3>
                                        <p>Call +91-9820466726</p>
                                        <a href="#" aria-label="Visit AASRA">aasra.info</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>iCall Helpline</h3>
                                        <p>Call +91-9152987821</p>
                                        <a href="#" aria-label="Visit iCall Helpline">icallhelpline.org</a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <i class="bx bx-globe"></i>
                                Additional Resources
                            </div>
                            <div class="card-body">
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Sangath</h3>
                                        <p>Mental health support services</p>
                                        <a href="#" aria-label="Visit Sangath">sangath.in</a>
                                    </div>
                                </div>
                                <div class="resource-item">
                                    <div class="resource-content">
                                        <h3>Mpower Helpline</h3>
                                        <p>Call 1800-120-820050</p>
                                        <a href="#" aria-label="Visit Mpower">mpower.org.in</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="disclaimer">
                        <p><strong>Important:</strong> MindAid is not a substitute for professional mental health care. In crisis situations, please contact emergency services or a crisis hotline immediately.</p>
                    </div>
                </section>

                <!-- Feedback Tab -->
                <section class="tab-content" id="feedback-tab">
                    <h2 class="tab-title"><i class="bx bx-comment"></i> Feedback</h2>
                    <div class="motivational">"Your feedback helps us grow and serve you better! 📝"</div>
                    <p>We value your input to improve MindAid Pro. Please share your thoughts below.</p>

                    <div class="feedback-form">
                        <textarea id="feedback-text" placeholder="Share your feedback or suggestions..." required aria-label="Feedback"></textarea>
                        <button id="feedback-btn" aria-label="Submit Feedback">Submit Feedback</button>
                    </div>
                </section>
            </div>
        </div>

        <footer>
            <p>MindAid Pro - Mental Health First Aid Assistant | This is a demonstration project only</p>
            <p>Note: Conversations are not stored or monitored. In real crisis situations, please contact professionals immediately.</p>
        </footer>
    </div>

    <script>
        (function () {
    // State Management
    let state = {
        isAuthenticated: false,
        currentUser: null,
        currentLanguage: localStorage.getItem("language") || "english",
        users: JSON.parse(localStorage.getItem("users")) || {},
        moodData: JSON.parse(localStorage.getItem("moodData")) || {},
        moodChart: null,
        conversationHistory: [], // Track user interactions in session
        lastResponseType: null, // Prevent repetitive responses
        streakCount: 0, // For gamifying mood logging
    };

    // Language Data (Updated for 10:40 PM IST, June 11, 2025)
    const languageData = {
        english: {
            initialMessages: [
                "Hi there! I’m MindAid, your mental health companion. 🌟 It’s 10:40 PM on a Wednesday—hope you’re winding down! How are you feeling tonight?",
                "Feel free to share anything on your mind, or use the quick options to get started. What’s up?",
            ],
            quickReplies: [
                { text: "I’m feeling anxious 😰", value: "anxiety" },
                { text: "I’m feeling down 😔", value: "depression" },
                { text: "I’m stressed out 😥", value: "stress" },
                { text: "I can’t sleep 🌙", value: "sleep" },
                { text: "I need coping ideas", value: "coping" },
            ],
            crisisResponse: "I’m really concerned for you—it’s late, and you’re not alone. Would you like to connect with a support resource right now?",
            copingStrategies: {
                anxiety: [
                    "Since it’s late, let’s try box breathing to calm your mind: inhale for 4 seconds, hold for 4, exhale for 4, pause for 4. Repeat 5 times. 🌬️ Ready to do this together?",
                    "The 5-4-3-2-1 grounding method can help: name 5 things you see, 4 you can touch, 3 you hear, 2 you smell, and 1 you taste. It eases anxious thoughts. 👀 Want to try?",
                    "A short walk outside, even just around your place, can lower stress hormones by up to 15%. Some fresh night air might help—up for it? 🌳",
                    "Writing down your worries for 5 minutes can clear your mind before bed. I can give you a prompt if you’d like! 📝",
                ],
                depression: [
                    "Connecting with someone you trust can lift your spirits, even with a quick message. Who could you reach out to tonight? 📞",
                    "Let’s do something small you enjoy, like listening to a calming song or sketching for 5 minutes. What sounds nice? 🎶",
                    "Try saying something kind to yourself, like ‘I’m doing my best, and that’s enough.’ How does that feel? 💖",
                    "Small wins matter, especially at night. How about making a warm drink to relax? ☕",
                ],
                stress: [
                    "Let’s break it down—what’s stressing you out the most right now? We can tackle it together, one step at a time. 📋",
                    "Progressive muscle relaxation can help you unwind before bed. Want to try tensing and releasing each muscle group? 🤸",
                    "A ‘done list’ can make you feel accomplished. What are 3 things you’ve done today, even small ones? ✅",
                    "Chamomile tea is perfect for late-night relaxation—it can ease tension. Want to give it a try? 🍵",
                ],
                sleep: [
                    "It’s 10:40 PM, so let’s set up a calming routine—maybe read a few pages or sip warm milk? 📖 What time do you want to sleep?",
                    "A cooler bedroom (around 60-67°F) can help you fall asleep faster by boosting melatonin production. 🛌",
                    "Caffeine can linger in your system for 6 hours—did you have any this evening that might be keeping you up? ☕",
                    "Soft nature sounds, like rain or waves, can help you drift off. Want a recommendation for a calming track? 🎶",
                ],
                relationships: [
                    "Active listening can strengthen bonds—try reflecting back what you hear to show you care. Want to practice? 👂",
                    "Use ‘I feel… when… because…’ to express yourself clearly. Let’s try it with something on your mind. 💬",
                    "Spending quality time, like sharing a late-night snack, can bring you closer. Could you plan something small? 🍽️",
                    "Resolving conflicts quickly can ease tension—how can we address what’s bothering you tonight? 🤝",
                ],
            },
            responses: {
                anxiety: "I can tell you’re feeling anxious, which can be tough this late at night. Let’s find a way to help you relax—how about a grounding technique? 🌈",
                depression: "I’m sorry you’re feeling down—it can be so heavy. Let’s take it slow and find something small to help tonight. 💡",
                stress: "Stress can feel overwhelming, especially at 10:40 PM. What’s been the biggest pressure for you today? Let’s work through it. 🤗",
                sleep: "Struggling to sleep at this hour isn’t easy. Would you like some tips to help you wind down for the night? 🌙",
                relationships: "Relationships can really affect how we feel. What’s been going on that you’d like to share? 💞",
                coping: "Here are some strategies that might help you tonight, based on what you’ve shared: ✨",
                thanks: "I’m so glad I could help! You’re doing great by reaching out—want to explore more? 🌟",
                thanksFollowUp: "I can share more ideas or resources if you’d like. What’s next for you tonight? 📚",
                generic: [
                    "Thanks for sharing—I’m here for you. How’s this affecting your evening? 🤔",
                    "I’m listening closely. What else should I know about how you’re feeling tonight? 🗣️",
                    "Let’s focus on what’s most important to you right now, especially this late. 👂",
                    "That sounds like a lot to handle. What would feel helpful for you tonight? 💭",
                    "Let’s find a small step you can take before bed—what feels manageable? 🚀",
                ],
                positiveSentiment: [
                    "You sound a bit brighter—that’s so great to hear! What’s lifting your spirits tonight? 😊",
                    "I’m picking up some positive vibes—love that! What’s been going well for you at this hour? 🥳",
                ],
                negativeSentiment: {
                    mild: "I can sense you’re not feeling your best tonight—I’m here to help. Want to talk more? 🥰",
                    severe: "I’m really sorry you’re feeling this way—it sounds so tough. Let’s find a way to ease things for you. 🤗",
                },
                followUp: {
                    anxiety: "Did that help calm your anxiety a bit, or should we try something else to relax tonight?",
                    depression: "How are you feeling now—any better? Want to try another small step to lift your mood?",
                    stress: "Is the stress feeling more manageable, or do you want to try another way to unwind before bed?",
                    sleep: "Are you feeling sleepier now, or do you need more ideas to help you rest?",
                    relationships: "Did that help at all, or would you like to talk more about what’s going on?",
                    generic: "How are you doing now? I’m here if you want to chat more or try something new. 😊",
                },
                proactive: {
                    anxiety: "I’ve noticed you’ve mentioned anxiety a few times—would you like to try a new technique tonight?",
                    depression: "You’ve seemed down lately—let’s find something to help you feel a bit better before bed.",
                    stress: "Stress has been coming up for you recently—want to try a new way to relax at this hour?",
                    sleep: "I remember you’ve had trouble sleeping before—shall we try something to help you tonight?",
                    relationships: "You’ve mentioned relationship challenges before—would you like to talk more about it now?",
                },
            },
        },
        hinglish: {
            initialMessages: [
                "Namaste! Main hoon MindAid, tera mental health dost. 🌸 Raat ke 10:40 ho gaye hain, Wednesday hai—tu kaisa hai abhi?",
                "Yahan dil khol ke baat kar sakta hai—type karega ya quick options se shuru karega?",
            ],
            quickReplies: [
                { text: "Abhi anxiety ho rahi hai 😰", value: "anxiety" },
                { text: "Udaas feel kar raha hoon 😔", value: "depression" },
                { text: "Bohot stress mein hoon 😥", value: "stress" },
                { text: "Neend nahi aa rahi 🌙", value: "sleep" },
                { text: "Coping ke liye ideas chahiye", value: "coping" },
            ],
            crisisResponse: "Mujhe lagta hai tu mushkil mein hai—tu akela nahi hai, yaar. Raat mein help ke liye kuch options bata doon?",
            copingStrategies: {
                anxiety: [
                    "Raat ho gayi hai, toh box breathing try karein: 4 second saans le, 4 hold, 4 chhod, 4 pause. 5 baar repeat kar—thoda relax hoga. 🌬️ Saath mein karein?",
                    "5-4-3-2-1 se dimag shant karte hain: 5 cheezein dekh, 4 chhu, 3 sun, 2 smell kar, 1 taste kar. Yeh anxiety kam karega. 👀 Try karein?",
                    "Thoda ghar ke bahar raat ki hawa mein ghoom aaye—stress hormones 15% tak kam ho sakte hain. Chalega? 🌳",
                    "5 minute ke liye apni chinta likh—sone se pehle dimag halka hoga. Topic chahiye? 📝",
                ],
                depression: [
                    "Kisi dost ya gharwale se baat kar—ek chhota sa message bhi mood thik kar sakta hai. Kisse baat karega? 📞",
                    "Kuch pasand ka kar—jaise 5 minute ke liye gaana sun ya drawing kar. Kya achha lagega? 🎶",
                    "Khud se pyar wali baat bol: ‘Main apna best kar raha hoon, aur yeh kaafi hai.’ Kaisa laga? 💖",
                    "Chhoti si jeet bhi badi hoti hai—raat ke liye garam doodh banayein? ☕",
                ],
                stress: [
                    "Sabse bada stress kya de raha hai—usko chhote steps mein baant lete hain. Kya bolta hai? 📋",
                    "Muscle relaxation se body ko aaram do—har muscle ko tense aur release karte hain. Try karein? 🤸",
                    "‘Done list’ banayein—3 cheezein likho jo tune aaj kiya, chhoti hi sahi. Kya likhega? ✅",
                    "Chamomile chai raat ke liye perfect hai—tension kam karegi. Pi lega? 🍵",
                ],
                sleep: [
                    "Ab 10:40 ho gaye hain—ek relaxing routine banayein, jaise kitab padhein ya garam doodh piyein. Kab soega? 📖",
                    "Thanda kamra (16-20°C) neend ke liye behtar hai—melatonin production badhega. 🛌",
                    "Caffeine 6 ghante tak body mein rehta hai—shaam ko piya tha kya jo neend affect kar raha hai? ☕",
                    "Barish ya samundar ki awaaz sone mein madad kar sakti hai—koi track suggest karoon? 🎶",
                ],
                relationships: [
                    "Active listening se rishte behtar hote hain—jo sune, usko repeat karke confirm karo. Practice karein? 👂",
                    "‘Mujhe aisa lagta hai jab… kyunki…’ se apni baat clear bolo. Kisi baat pe try karein? 💬",
                    "Raat ka khana saath mein kha sakte ho—rishte majboot honge. Plan karein? 🍽️",
                    "Jhagda jaldi solve karna better hai—iss baat ko kaise handle karein? 🤝",
                ],
            },
            responses: {
                anxiety: "Teri anxiety samajh raha hoon—raat ke 10:40 pe yeh aur tough lagta hai. Kuch relaxing try karein? 🌈",
                depression: "Udaasi bohot bhari hoti hai—mujhe afsos hai. Aaj raat ek chhoti si cheez se shuru karein? 💡",
                stress: "Stress raat ke waqt aur bhi zyada lagta hai. Sabse bada pressure kya hai—baat karein? 🤗",
                sleep: "10:40 PM pe neend na aaye toh mushkil hai. Sone ke liye kuch tips try karein? 🌙",
                relationships: "Rishton ka asar bohot hota hai dil pe. Kya chal raha hai—bata mujhe? 💞",
                coping: "Jo tune bataya, uske hisab se yeh ideas raat ke liye kaam kar sakte hain: ✨",
                thanks: "Tune baat share ki—bohot acha kiya! Aur kuch explore karein? 🌟",
                thanksFollowUp: "Aur ideas ya resources dekhna hai kya—kya chahiye? 📚",
                generic: [
                    "Baat batane ke liye shukriya—iss se teri raat pe kya asar pada? 🤔",
                    "Main dhyan se sun raha hoon—aur kya batana chahiye mujhe? 🗣️",
                    "Abhi raat mein kya sabse zyada matter kar raha hai tujhe? 👂",
                    "Yeh thoda heavy lag raha hai—raat ke liye kya help chahiye? 💭",
                    "Raat ke liye ek chhota step plan karein—kya theek lagega? 🚀",
                ],
                positiveSentiment: [
                    "Tu thoda khush lag raha hai—bohot acha hai! Raat ko kya tujhe khushi de raha hai? 😊",
                    "Achhe vibes aa rahe hain—mast hai! Is waqt kya acha chal raha hai? 🥳",
                ],
                negativeSentiment: {
                    mild: "Raat mein tu thoda down lag raha hai—main hoon na, baat karein? 🥰",
                    severe: "Bohot pareshan hai tu—mujhe bura lag raha hai. Raat ke liye kuch karte hain? 🤗",
                },
                followUp: {
                    anxiety: "Abhi thoda relax hua kya, ya raat ke liye kuch aur try karein?",
                    depression: "Mood thoda better hua kya, ya aur kuch karna hai aaj raat?",
                    stress: "Stress kam hua kya, ya sone se pehle kuch aur try karein?",
                    sleep: "Ab neend aa rahi hai kya, ya aur tips chahiye sone ke liye?",
                    relationships: "Kuch farak pada kya, ya aur baat karni hai iske bare mein?",
                    generic: "Ab kaisa lag raha hai? Aur baat karni hai ya kuch naya try karna hai? 😊",
                },
                proactive: {
                    anxiety: "Pehle bhi anxiety ki baat ki thi na—raat ke liye kuch naya try karein?",
                    depression: "Pehle bhi udaas laga tha—raat ke liye mood thik karne ka idea doon?",
                    stress: "Stress pehle bhi bola tha—abhi raat mein relax karne ka naya idea try karein?",
                    sleep: "Pehle bhi neend ki baat ki thi—abhi sone ke liye kuch aur try karein?",
                    relationships: "Rishton ke bare mein pehle bhi bola tha—abhi baat karein ya kuch karna hai?",
                },
            },
        },
        tanglish: {
            initialMessages: [
                "Vanakkam! Naan MindAid, un mental health dostu. 😊 Ippo raathiri 10:40 aagudhu, Budhan kizhamai—nee eppadi irukke?",
                "Inga open-ah pesalam—type pannuviya illa quick options use pannuviya?",
            ],
            quickReplies: [
                { text: "Ippo anxiety aagudhu 😰", value: "anxiety" },
                { text: "Manasu downa irukku 😔", value: "depression" },
                { text: "Romba stress aa irukku 😥", value: "stress" },
                { text: "Thoongamudiyala 🌙", value: "sleep" },
                { text: "Coping ideas venum", value: "coping" },
            ],
            crisisResponse: "Ungalukku kashtama irukku nu puriyudhu—nee thaniya illa da. Raathiri help pannava, options sollava?",
            copingStrategies: {
                anxiety: [
                    "Raathiri aagiduchu, box breathing pannuvom: 4 seconds saans edu, 4 hold, 4 vidu, 4 pause. 5 thadava pannu—relax aagum. 🌬️ Saathu pannuvoma?",
                    "5-4-3-2-1 method try pannu: 5 paakuren, 4 thotturen, 3 ketkuren, 2 smell pannuren, 1 taste pannuren. Anxiety kammi aagum. 👀 Pannuviya?",
                    "Veedu pakkathula raathiri hawa-la nadanthu vaa—stress hormones 15% kammi aagum. Try pannuviya? 🌳",
                    "5 minute ezhuthi paaru—thoongaradhukku munna mind clear aagum. Topic venuma? 📝",
                ],
                depression: [
                    "Nambikkai ulla friend-a illa family-a konjam pesu—chumma message pannina kooda mood maaraum. Yaarukku message pannuviya? 📞",
                    "Unakku pudicha 5 minute activity pannu—paattu kekkuriaya illa drawing pannuviya? Enna pannalam? 🎶",
                    "Nee unna ‘Naan try pannuren, adhu podhum’ nu sollunga. Eppadi irukku? 💖",
                    "Chinna vishayam pannuvom—raathiri paal heat pannuviya? ☕",
                ],
                stress: [
                    "Enna stress romba irukku—adha chinnachinna steps-a pannuvom. Enna pannalam? 📋",
                    "Muscle relaxation pannina body relax aagum—muscles-a tense pannitu release pannuvom. Try pannuviya? 🤸",
                    "‘Done list’ ezhuthuvom—3 vishayam innaiku pannirukke, ezhuthu paakalam. Enna ezhuthuviya? ✅",
                    "Chamomile tea raathiri nalla irukum—tension kammi aagum. Kudichu paakuriaya? 🍵",
                ],
                sleep: [
                    "Ippo 10:40 aagudhu—calming routine pannuvom, paal kudichu illa book padichu thoonguviya? Eppadi thoonguviya? 📖",
                    "Cool room (16-20°C) thoongarathukku help pannum—melatonin production perugum. 🛌",
                    "Caffeine 6 hours body-la irukum—evening coffee/tea affect pannudhuya? ☕",
                    "Western Ghats rain sound kettu thoongalam—thoongarathukku help aagum. Track venuma? 🎶",
                ],
                relationships: [
                    "Active listening pannina rishte nalla irukum—ketta pinadi repeat panni confirm pannu. Practice pannuviya? 👂",
                    "‘Enakku ippadi thonudhu appadiyae…’ nu solli clear-a pesuvom. Try pannuviya? 💬",
                    "Raathiri sapadu saathu saapidalam—relationship strong aagum. Plan pannuviya? 🍽️",
                    "Jhagda jaldi solve pannina nalladhu—idha eppadi handle pannalam? 🤝",
                ],
            },
            responses: {
                anxiety: "Raathiri 10:40 la anxiety aagudhu nu puriyudhu—kashtama irukum. Grounding techniques pannuvoma? 🌈",
                depression: "Manasu downa irukku—adhu heavy-a irukum da. Innaiku raathiri konjam help pannuvoma? 💡",
                stress: "Stress raathiri romba feel aagum—enna main pressure, pesuvoma? 🤗",
                sleep: "10:40 PM aagiduchu—thoongaradhu kashtam. Thoongarathukku tips try pannuviya? 🌙",
                relationships: "Rishte manasula romba impact pannum—enna nadakkudhu, sollu paakalam? 💞",
                coping: "Nee solradha paatha, intha ideas raathiri unakku help pannum: ✨",
                thanks: "Nee share pannirukke—romba nalladhu! Innum explore pannuviya? 🌟",
                thanksFollowUp: "Innum ideas illa resources paaklama—enna venum? 📚",
                generic: [
                    "Share pannirukke, nandri—idhu un raathiri eppadi affect pannudhu? 🤔",
                    "Naan ketkuren—innum enna purinjukka venum? 🗣️",
                    "Raathiri unakku enna mukkiyam aagudhu? 👂",
                    "Idhu konjam kashtama irukku—raathiri enna help venum? 💭",
                    "Raathiri konjam plan pannuvom—enna pannuviya? 🚀",
                ],
                positiveSentiment: [
                    "Nee konjam happy-a irukke—super da! Raathiri enna unakku santhoshama irukku? 😊",
                    "Nalla vibe-a irukke—mast! Ippo enna nalladhu nadakkudhu? 🥳",
                ],
                negativeSentiment: {
                    mild: "Raathiri konjam down-a irukke—naan irukken, pesuvoma? 🥰",
                    severe: "Romba kashtama irukku nu puriyudhu—sorry da. Raathiri konjam help pannuvoma? 🤗",
                },
                followUp: {
                    anxiety: "Ippo anxiety konjam kammi aacha, illa raathiri vera pannuvoma?",
                    depression: "Mood konjam maariyacha, illa innaiku raathiri vera pannuvoma?",
                    stress: "Stress kammi aacha, illa thoongaradhukku munna vera try pannuvoma?",
                    sleep: "Ippo thoongalam nu thonudha, illa innum tips venuma?",
                    relationships: "Idhu help pannucha, illa innum pesanuma idhpathi?",
                    generic: "Ippo eppadi irukke? Innum pesanuma illa vera pannanuma? 😊",
                },
                proactive: {
                    anxiety: "Munnadiyum anxiety pathi sonniya—raathiri konjam vera try pannuvoma?",
                    depression: "Munnadiyum manasu down-nu sonniya—raathiri mood maara idea venuma?",
                    stress: "Munnadiyum stress pathi sonniya—raathiri relax pannurathukku idea paaklama?",
                    sleep: "Munnadiyum thoongala nu sonniya—ippo thoongarathukku help pannuvoma?",
                    relationships: "Munnadiyum rishte pathi sonniya—ippo pesanuma illa vera pannanuma?",
                },
            },
        },
    };

    // Crisis Detection Configuration
    const crisisConfig = {
        keywords: [
            "suicide", "kill myself", "end my life", "want to die", "harm myself",
            "self-harm", "hopeless", "no point", "give up", "cannot go on", "worthless",
        ],
        resources: [
            "Vandrevala Foundation: <strong>Call 9999666555</strong>",
            "AASRA Suicide Prevention: <strong>Call +91-9820466726</strong>",
            "iCall Helpline: <strong>Call +91-9152987821</strong>",
            "Mpower Emergency: <strong>Call 1800-120-820050</strong>",
            "Emergency Services: <strong>112</strong>",
        ],
    };

    // NLP Configuration
    const nlpConfig = {
        sentimentThresholds: {
            positive: 0.3,
            negativeMild: -0.3,
            negativeSevere: -0.7,
        },
        intents: {
            greeting: ["hi", "hello", "hey", "namaste", "vanakkam"],
            thanks: ["thanks", "thank you", "shukriya", "nandri"],
            goodbye: ["bye", "goodbye", "see you", "chalta hoon", "poitu varen"],
            coping: ["coping", "tips", "ideas", "help me", "what can i do", "venum"],
            moodCheck: ["how am i", "my mood", "feeling", "lag raha", "irukku"],
        },
        emotionKeywords: {
            anxiety: ["anxious", "worried", "nervous", "ghabrahat", "bayama"],
            depression: ["sad", "down", "depressed", "low", "udaas", "downa"],
            stress: ["stressed", "pressure", "overwhelmed", "tension", "stress aa"],
            sleep: ["sleep", "insomnia", "can’t sleep", "neend", "thoongala"],
            relationships: ["relationship", "friend", "family", "rishton", "vishayam"],
        },
    };

    // Utility Functions
    const utils = {
        formatTime: (date) => date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }),
        triggerConfetti: () => confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 },
            colors: ["#ff6f91", "#a29bfe", "#feca57"],
        }),
        triggerEmojiBurst: (container, emojis) => {
            for (let i = 0; i < 5; i++) {
                const emoji = document.createElement("span");
                emoji.classList.add("emoji-burst");
                emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                emoji.style.left = `${Math.random() * 100}%`;
                emoji.style.top = `${Math.random() * 100}%`;
                container.appendChild(emoji);
            }
        },
        addMessage: (text, isUser = false) => {
            const messageDiv = document.createElement("div");
            messageDiv.classList.add("message", isUser ? "user-message" : "bot-message");
            const now = new Date();
            messageDiv.innerHTML = `${text}<span class="message-time">${utils.formatTime(now)}</span>`;
            elements.chatContainer.appendChild(messageDiv);
            elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;
        },
        showTyping: () => {
            const typingDiv = document.createElement("div");
            typingDiv.classList.add("typing-indicator");
            typingDiv.id = "typing-indicator";
            typingDiv.innerHTML = `
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
            `;
            elements.chatContainer.appendChild(typingDiv);
            elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;
            return typingDiv;
        },
        hideTyping: () => {
            const typingIndicator = document.getElementById("typing-indicator");
            if (typingIndicator) typingIndicator.remove();
        },
        calculateStreak: (moodData) => {
            const today = new Date();
            let streak = 0;
            for (let i = 0; i < 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                const dateStr = date.toISOString().split("T")[0];
                const hasMood = moodData.some(entry => entry.date === dateStr);
                if (!hasMood) break;
                streak++;
            }
            return streak;
        },
    };

    // DOM Elements
    const elements = {
        authContainer: document.getElementById("auth-container"),
        mainApp: document.getElementById("main-app"),
        loginForm: document.getElementById("login-form"),
        registerForm: document.getElementById("register-form"),
        toggleToRegister: document.getElementById("toggle-to-register"),
        toggleToLogin: document.getElementById("toggle-to-login"),
        logoutBtn: document.getElementById("logout-btn"),
        languageSelector: document.getElementById("language-selector"),
        chatContainer: document.getElementById("chat-messages"),
        quickRepliesContainer: document.getElementById("quick-replies"),
        userInput: document.getElementById("user-input"),
        sendBtn: document.getElementById("send-btn"),
        tabLinks: document.querySelectorAll(".nav-item"),
        tabContents: document.querySelectorAll(".tab-content"),
        moodButtons: document.querySelectorAll(".mood-btn"),
        actionChecks: document.querySelectorAll(".action-check"),
        feedbackBtn: document.getElementById("feedback-btn"),
        feedbackText: document.getElementById("feedback-text"),
    };

    // NLP Engine
    const nlp = {
        analyzeSentiment: (message) => {
            const positiveWords = ["good", "great", "happy", "awesome", "nice", "khush", "nalla"];
            const negativeWords = ["bad", "sad", "terrible", "awful", "down", "udaas", "kashtam"];
            const lowerMsg = message.toLowerCase();
            let score = 0;

            positiveWords.forEach(word => {
                if (lowerMsg.includes(word)) score += 0.5;
            });
            negativeWords.forEach(word => {
                if (lowerMsg.includes(word)) score -= 0.5;
            });

            if (score >= nlpConfig.sentimentThresholds.positive) return "positive";
            if (score <= nlpConfig.sentimentThresholds.negativeSevere) return "negativeSevere";
            if (score <= nlpConfig.sentimentThresholds.negativeMild) return "negativeMild";
            return "neutral";
        },
        detectIntent: (message) => {
            const lowerMsg = message.toLowerCase();
            for (const [intent, keywords] of Object.entries(nlpConfig.intents)) {
                if (keywords.some(keyword => lowerMsg.includes(keyword))) {
                    return intent;
                }
            }
            return "unknown";
        },
        detectEmotion: (message) => {
            const lowerMsg = message.toLowerCase();
            for (const [emotion, keywords] of Object.entries(nlpConfig.emotionKeywords)) {
                if (keywords.some(keyword => lowerMsg.includes(keyword))) {
                    return emotion;
                }
            }
            return null;
        },
        scoreResponse: (message, userMoodTrend, timeOfDay) => {
            const emotion = nlp.detectEmotion(message) || "generic";
            const sentiment = nlp.analyzeSentiment(message);
            const intent = nlp.detectIntent(message);
            let score = 0;

            // Emotion-based scoring
            if (emotion !== "generic") score += 3;
            if (timeOfDay === "night" && emotion === "sleep") score += 2;

            // Sentiment-based scoring
            if (sentiment === "positive") score += 1;
            if (sentiment === "negativeSevere") score += 2;

            // Intent-based scoring
            if (intent === "coping") score += 2;
            if (intent === "thanks") score += 1;

            // User history-based scoring
            if (userMoodTrend === "negative" && ["anxiety", "depression", "stress"].includes(emotion)) score += 1;

            return { emotion, sentiment, intent, score };
        },
    };

    // Recommendation Engine
    const recommender = {
        getPersonalizedTips: (emotion, userMoodTrend) => {
            const lang = languageData[state.currentLanguage];
            const allTips = lang.copingStrategies[emotion] || [];
            const userMoods = state.moodData[state.currentUser] || [];
            const recentMoods = userMoods.slice(-3).map(m => m.value);

            // Prioritize tips based on user history and current emotion
            if (emotion === "sleep" && recentMoods.every(m => m <= 3)) {
                return allTips.filter(tip => tip.includes("calming routine") || tip.includes("nature sounds"));
            }
            if (emotion === "depression" && userMoodTrend === "negative") {
                return allTips.filter(tip => tip.includes("connecting") || tip.includes("self-compassion"));
            }
            return allTips.sort(() => 0.5 - Math.random()).slice(0, 3);
        },
        getUserMoodTrend: () => {
            const userMoods = state.moodData[state.currentUser] || [];
            const recentMoods = userMoods.slice(-5).map(m => m.value);
            if (recentMoods.length < 3) return "neutral";
            const averageMood = recentMoods.reduce((a, b) => a + b, 0) / recentMoods.length;
            return averageMood < 3 ? "negative" : averageMood > 3 ? "positive" : "neutral";
        },
    };

    // Authentication
    const auth = {
        initialize: () => {
            try {
                if (localStorage.getItem("currentUser")) {
                    state.isAuthenticated = true;
                    state.currentUser = localStorage.getItem("currentUser");
                    elements.authContainer.style.display = "none";
                    elements.mainApp.style.display = "flex";
                    utils.triggerConfetti();
                    app.initializeMoodChart();
                    app.updateChatLanguage();
                }
            } catch (error) {
                console.error("Auth initialization failed:", error);
            }
        },
        login: () => {
            const email = document.getElementById("login-email").value;
            const password = document.getElementById("login-password").value;
            if (!email || !password) {
                alert("Please enter both email and password.");
                return;
            }
            if (state.users[email] && state.users[email].password === password) {
                state.isAuthenticated = true;
                state.currentUser = email;
                localStorage.setItem("currentUser", email);
                elements.authContainer.style.display = "none";
                elements.mainApp.style.display = "flex";
                app.initializeMoodChart();
                app.updateChatLanguage();
                utils.triggerConfetti();
            } else {
                alert("Invalid email or password!");
            }
        },
        register: () => {
            const email = document.getElementById("register-email").value;
            const password = document.getElementById("register-password").value;
            const confirmPassword = document.getElementById("confirm-password").value;
            if (!email || !password || !confirmPassword) {
                alert("Please fill in all fields.");
                return;
            }
            if (password !== confirmPassword) {
                alert("Passwords do not match!");
                return;
            }
            if (state.users[email]) {
                alert("User already exists!");
                return;
            }
            state.users[email] = { password, moods: [] };
            localStorage.setItem("users", JSON.stringify(state.users));
            alert("Registration successful! Please login.");
            elements.loginForm.style.display = "flex";
            elements.registerForm.style.display = "none";
        },
        logout: () => {
            state.isAuthenticated = false;
            state.currentUser = null;
            state.conversationHistory = [];
            localStorage.removeItem("currentUser");
            elements.authContainer.style.display = "flex";
            elements.mainApp.style.display = "none";
            elements.loginForm.style.display = "flex";
            elements.registerForm.style.display = "none";
        },
    };

    // Main App Logic
    const app = {
        initializeMoodChart: () => {
            try {
                const moodCtx = document.getElementById("mood-chart").getContext("2d");
                const userMoods = state.moodData[state.currentUser] || [];
                const labels = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];
                const data = Array(7).fill(null);

                userMoods.forEach((mood) => {
                    const date = new Date(mood.date);
                    const dayIndex = date.getDay() === 0 ? 6 : date.getDay() - 1;
                    data[dayIndex] = mood.value;
                });

                state.moodChart = new Chart(moodCtx, {
                    type: "line",
                    data: {
                        labels,
                        datasets: [{
                            label: "Mood Level",
                            data,
                            borderColor: "#ff6f91",
                            backgroundColor: "rgba(255, 111, 145, 0.1)",
                            borderWidth: 3,
                            pointRadius: 6,
                            pointBackgroundColor: "#ff6f91",
                            tension: 0.3,
                            fill: true,
                        }],
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                min: 1,
                                max: 5,
                                ticks: {
                                    callback: (value) => {
                                        const moods = ["Terrible", "Poor", "Neutral", "Good", "Excellent"];
                                        return moods[value - 1];
                                    },
                                },
                            },
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: (context) => {
                                        const moods = ["Terrible", "Poor", "Neutral", "Good", "Excellent"];
                                        return context.parsed.y ? moods[context.parsed.y - 1] : "No data";
                                    },
                                },
                            },
                        },
                    },
                });
            } catch (error) {
                console.error("Mood chart initialization failed:", error);
            }
        },
        updateChatLanguage: () => {
            const lang = languageData[state.currentLanguage];
            app.updateQuickReplies(lang.quickReplies);
            const initialMessageDiv = document.getElementById("initial-message");
            const now = new Date();
            initialMessageDiv.innerHTML = `${lang.initialMessages[0]}<span class="message-time">${utils.formatTime(now)}</span>`;
        },
        updateQuickReplies: (replies) => {
            elements.quickRepliesContainer.innerHTML = "";
            replies.forEach((reply) => {
                const button = document.createElement("button");
                button.classList.add("quick-reply");
                button.setAttribute("data-reply", reply.value);
                button.textContent = reply.text;
                button.setAttribute("aria-label", reply.text);
                elements.quickRepliesContainer.appendChild(button);
                button.addEventListener("click", () => {
                    const replyText = button.textContent;
                    const replyValue = button.getAttribute("data-reply");
                    utils.addMessage(replyText, true);
                    state.conversationHistory.push({ user: replyText, intent: replyValue });
                    const typingIndicator = utils.showTyping();
                    chat.generateResponse(replyText);
                    utils.triggerEmojiBurst(elements.chatContainer, ["😊", "🌟", "💖"]);
                });
            });
        },
        updateDynamicQuickReplies: (context) => {
            const lang = languageData[state.currentLanguage];
            let dynamicReplies = [...lang.quickReplies];
            if (context === "sleep") {
                dynamicReplies = [
                    { text: "I’ll try a routine 📖", value: "sleep_routine" },
                    { text: "Any calming sounds? 🎶", value: "sleep_sounds" },
                    { text: "I had caffeine earlier ☕", value: "sleep_caffeine" },
                ];
            } else if (context === "thanks") {
                dynamicReplies = [
                    { text: "Yes, more ideas please! 📚", value: "more_ideas" },
                    { text: "I’m good for now 😊", value: "goodbye" },
                ];
            }
            app.updateQuickReplies(dynamicReplies);
        },
    };

    // Chat Logic
    const chat = {
        generateResponse: (userMessage) => {
            const lowerMsg = userMessage.toLowerCase();
            const lang = languageData[state.currentLanguage];
            const hasCrisis = crisisConfig.keywords.some(keyword => lowerMsg.includes(keyword));

            // Store user message in conversation history
            state.conversationHistory.push({ user: userMessage });

            if (hasCrisis) {
                setTimeout(() => {
                    utils.hideTyping();
                    const alertDiv = document.createElement("div");
                    alertDiv.classList.add("crisis-alert");
                    alertDiv.innerHTML = `
                        <strong>⚠️ Crisis Detected</strong><br>
                        Your message suggests you might be in crisis. Please reach out to these resources immediately:
                    `;
                    const resourcesDiv = document.createElement("div");
                    resourcesDiv.classList.add("resources-card");
                    resourcesDiv.innerHTML = crisisConfig.resources.join("<br />");
                    elements.chatContainer.appendChild(alertDiv);
                    elements.chatContainer.appendChild(resourcesDiv);
                    elements.chatContainer.scrollTop = elements.chatContainer.scrollHeight;

                    setTimeout(() => {
                        utils.addMessage(lang.crisisResponse);
                        app.updateDynamicQuickReplies("crisis");
                    }, 1000);
                }, 1500);
                return;
            }

            setTimeout(() => {
                utils.hideTyping();
                const userMoodTrend = recommender.getUserMoodTrend();
                const timeOfDay = new Date().getHours() >= 18 ? "night" : "day";
                const { emotion, sentiment, intent, score } = nlp.scoreResponse(userMessage, userMoodTrend, timeOfDay);

                // Intent-based responses
                if (intent === "greeting") {
                    utils.addMessage(lang.initialMessages[1]);
                    state.lastResponseType = "greeting";
                    return;
                }
                if (intent === "thanks") {
                    utils.addMessage(lang.responses.thanks);
                    setTimeout(() => {
                        utils.addMessage(lang.responses.thanksFollowUp);
                        app.updateDynamicQuickReplies("thanks");
                    }, 1000);
                    state.lastResponseType = "thanks";
                    return;
                }
                if (intent === "goodbye") {
                    utils.addMessage("Take care! I’m here if you need me later. 🌙");
                    state.lastResponseType = "goodbye";
                    return;
                }
                if (intent === "moodCheck") {
                    const trend = recommender.getUserMoodTrend();
                    utils.addMessage(`Based on your recent moods, you’ve been feeling ${trend}. How can I help you tonight?`);
                    state.lastResponseType = "moodCheck";
                    return;
                }

                // Emotion-based responses
                if (emotion !== "generic") {
                    const responseKey = emotion;
                    const proactiveCheck = state.conversationHistory.filter(h => h.intent === emotion).length > 2;
                    if (proactiveCheck && state.lastResponseType !== "proactive") {
                        utils.addMessage(lang.responses.proactive[emotion]);
                        state.lastResponseType = "proactive";
                    } else {
                        utils.addMessage(lang.responses[responseKey]);
                        const personalizedTips = recommender.getPersonalizedTips(emotion, userMoodTrend);
                        chat.sendCopingTips(personalizedTips, lang.responses);
                        state.lastResponseType = "emotion";
                    }
                    app.updateDynamicQuickReplies(emotion);
                    return;
                }

                // Sentiment-based responses
                if (sentiment === "positive" && state.lastResponseType !== "positiveSentiment") {
                    const randomResponse = lang.responses.positiveSentiment[Math.floor(Math.random() * lang.responses.positiveSentiment.length)];
                    utils.addMessage(randomResponse);
                    state.lastResponseType = "positiveSentiment";
                    return;
                }
                if (sentiment === "negativeMild" || sentiment === "negativeSevere") {
                    const responseKey = sentiment === "negativeMild" ? "mild" : "severe";
                    utils.addMessage(lang.responses.negativeSentiment[responseKey]);
                    state.lastResponseType = "negativeSentiment";
                    return;
                }

                // Fallback to generic response
                const randomResponse = lang.responses.generic[Math.floor(Math.random() * lang.responses.generic.length)];
                utils.addMessage(randomResponse);
                state.lastResponseType = "generic";
            }, 1500);
        },
        sendCopingTips: (tips, responses) => {
            tips.forEach((tip, index) => {
                setTimeout(() => {
                    utils.addMessage(tip);
                    if (index === tips.length - 1) {
                        setTimeout(() => {
                            utils.addMessage(responses.followUp.generic);
                        }, 1000);
                    }
                }, index * 1000);
            });
        },
    };

    // Event Listeners
    const setupEventListeners = () => {
        elements.toggleToRegister.addEventListener("click", () => {
            elements.loginForm.style.display = "none";
            elements.registerForm.style.display = "flex";
        });

        elements.toggleToLogin.addEventListener("click", () => {
            elements.loginForm.style.display = "flex";
            elements.registerForm.style.display = "none";
        });

        document.getElementById("register-btn").addEventListener("click", auth.register);
        document.getElementById("login-btn").addEventListener("click", auth.login);
        elements.logoutBtn.addEventListener("click", auth.logout);

        elements.languageSelector.addEventListener("change", () => {
            state.currentLanguage = elements.languageSelector.value;
            localStorage.setItem("language", state.currentLanguage);
            app.updateChatLanguage();
        });

        elements.tabLinks.forEach((link) => {
            link.addEventListener("click", (e) => {
                e.preventDefault();
                if (link.getAttribute("data-tab") === "mood" && !state.isAuthenticated) {
                    alert("Please login to access the Mood Tracker");
                    return;
                }
                elements.tabLinks.forEach((l) => l.classList.remove("active"));
                link.classList.add("active");
                elements.tabContents.forEach((c) => c.classList.remove("active"));
                document.getElementById(`${link.getAttribute("data-tab")}-tab`).classList.add("active");
            });
        });

        elements.moodButtons.forEach((btn) => {
            btn.addEventListener("click", () => {
                elements.moodButtons.forEach((b) => b.classList.remove("selected"));
                btn.classList.add("selected");

                const mood = btn.getAttribute("data-mood");
                const moodValues = {
                    excellent: 5,
                    good: 4,
                    neutral: 3,
                    poor: 2,
                    terrible: 1,
                };
                const moodValue = moodValues[mood];
                const today = new Date().toISOString().split("T")[0];

                if (!state.moodData[state.currentUser]) {
                    state.moodData[state.currentUser] = [];
                }

                const existingMood = state.moodData[state.currentUser].find((entry) => entry.date === today);
                if (existingMood) {
                    existingMood.value = moodValue;
                } else {
                    state.moodData[state.currentUser].push({ date: today, value: moodValue });
                }

                localStorage.setItem("moodData", JSON.stringify(state.moodData));
                state.moodChart.destroy();
                app.initializeMoodChart();

                state.streakCount = utils.calculateStreak(state.moodData[state.currentUser]);
                utils.triggerConfetti();
                alert(`Mood logged successfully! You’re on a ${state.streakCount}-day streak—keep it up! 🌟`);
            });
        });

        elements.actionChecks.forEach((check) => {
            check.addEventListener("click", () => {
                check.classList.toggle("checked");
                if (check.classList.contains("checked")) {
                    utils.triggerConfetti();
                    const emojiContainer = check.closest(".action-item");
                    utils.triggerEmojiBurst(emojiContainer, ["🎉", "✅", "🌟"]);
                }
            });
        });

        elements.feedbackBtn.addEventListener("click", () => {
            const feedback = elements.feedbackText.value.trim();
            if (!feedback) {
                alert("Please provide your feedback before submitting.");
                return;
            }
            alert("Thank you for your feedback! We’ll use it to improve MindAid. 💬");
            elements.feedbackText.value = "";
            utils.triggerConfetti();
        });

        elements.sendBtn.addEventListener("click", () => {
            const userMessage = elements.userInput.value.trim();
            if (!userMessage) return;
            utils.addMessage(userMessage, true);
            elements.userInput.value = "";
            const typingIndicator = utils.showTyping();
            chat.generateResponse(userMessage);
            utils.triggerEmojiBurst(elements.chatContainer, ["😊", "🌟", "💖"]);
        });

        elements.userInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter") {
                elements.sendBtn.click();
            }
        });
    };

    // Initialize
    const init = () => {
        elements.languageSelector.value = state.currentLanguage;
        auth.initialize();
        app.updateChatLanguage();
        setupEventListeners();
    };

    init();
})();</script>
</body>
</html>
